---
title: "Rapport IF36"
author: "Ahamad MOHAMMAD, Minko Bikono NEIL-JOVY, Simon GELBART, Willen AMICHE"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: cayman       
    highlight: github   
    toc: true
    toc_depth: 3
encoding: UTF-8
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,     
  warning = FALSE,  
  message = FALSE   
)
```



## **Introduction**
Lâ€™objectif de ce projet est dâ€™explorer lâ€™impact des stratÃ©gies de recrutement sur les performances sportives des clubs de football et de leurs joueurs. En croisant des statistiques individuelles (performances des joueurs), des donnÃ©es collectives (rÃ©sultats dâ€™Ã©quipes) et les transferts rÃ©alisÃ©s lors du mercato estival 2022, nous cherchons Ã  identifier les leviers de performance et Ã  mieux comprendre les choix stratÃ©giques opÃ©rÃ©s par les clubs.
Notre analyse se base sur deux saisons complÃ¨tes (2021-2022 et 2022-2023), afin de mesurer lâ€™Ã©volution des rÃ©sultats dâ€™une annÃ©e sur lâ€™autre et de relier cette Ã©volution aux dynamiques de recrutement. Ã€ travers plusieurs angles dâ€™analyse (volume de transferts, postes ciblÃ©s, valeur marchande, origine des joueurs, rendement, etc.), nous chercherons Ã  rÃ©pondre Ã  une sÃ©rie de questions permettant de quantifier et qualifier l'effet des recrutements sur la rÃ©ussite des Ã©quipes.

 


### **ğŸ“Š Description des variables**

#### - ğŸ§â€â™‚ï¸ Player Stats 2021-2022 (`2021-2022 Football Player Stats.csv`)

143 variables â€“ chaque ligne correspond Ã  un joueur pour la saison 2021-2022.

| Variable          | Type      | Description approximative |
|-------------------|-----------|----------------------------|
| `Rk`              | int64     | Rang ou ID du joueur       |
| `Player`          | object    | Nom du joueur              |
| `Nation`          | object    | NationalitÃ©                |
| `Pos`             | object    | Poste                      |
| `Squad`           | object    | Club                       |
| `Comp`            | object    | CompÃ©tition principale     |
| `Age`             | object    | Ã‚ge                        |
| `Born`            | object    | AnnÃ©e de naissance         |
| ...               | ...       | ...et plus de 130 autres statistiques de jeu : buts, passes, tirs, dribbles, fautes, tacles, interceptions, passes progressives, etc. |
| `AerWon`          | float64   | Duels aÃ©riens gagnÃ©s       |
| `AerLost`         | float64   | Duels aÃ©riens perdus       |
| `AerWon%`         | float64   | Pourcentage de duels aÃ©riens gagnÃ©s |

---

#### - ğŸŸï¸ Team Stats 2021-2022 (`2021-2022 Football Team Stats.csv`)

20 variables â€“ chaque ligne correspond Ã  une Ã©quipe.

| Variable          | Type      | Description |
|------------------|-----------|-------------|
| `Rk`             | int64     | Rang        |
| `Squad`          | object    | Nom du club |
| `Country`        | object    | Pays        |
| `LgRk`           | int64     | Classement dans la ligue |
| `MP`, `W`, `D`, `L` | int64  | Matchs jouÃ©s, Victoires, Nuls, DÃ©faites |
| `GF`, `GA`, `GD` | int64     | Buts pour, contre, diffÃ©rence |
| `Pts`, `Pts/G`   | int64 / float64 | Points et moyenne par match |
| `xG`, `xGA`, `xGD`, `xGD/90` | float64 | DonnÃ©es dâ€™expected goals |
| `Attendance`     | int64     | Affluence moyenne |
| `Top Team Scorer`| object    | Meilleur buteur |
| `Goalkeeper`     | object    | Gardien principal |

---

#### - ğŸŸï¸ Team Stats 2022-2023 (`2022-2023 Football Team Stats.csv`)

MÃªme structure et signification que pour 2021-2022, mais avec la saison suivante.

---

#### - ğŸ”„ Transfers Ã‰tÃ© 2022 (`2022_2023_football_summer_transfers.csv`)

11 variables â€“ chaque ligne correspond Ã  un transfert.

| Variable        | Type    | Description |
|----------------|---------|-------------|
| `name`         | object  | Nom du joueur transfÃ©rÃ© |
| `position`     | object  | Poste            |
| `age`          | object  | Ã‚ge              |
| `market_value` | object  | Valeur estimÃ©e   |
| `country_from` | object  | Pays de dÃ©part   |
| `league_from`  | object  | Ligue de dÃ©part  |
| `club_from`    | object  | Club de dÃ©part   |
| `country_to`   | object  | Pays dâ€™arrivÃ©e   |
| `league_to`    | object  | Ligue dâ€™arrivÃ©e  |
| `club_to`      | object  | Club dâ€™arrivÃ©e   |
| `fee`          | object  | Montant du transfert (peut contenir "Free", "Loan", etc.) |

---

## **Analyse et rÃ©ponses aux questions**


```{r chargement-librairies, message=FALSE}
# Chargement des packages nÃ©cessaires

library(tidyverse)
library(ggplot2)
library(scales)
library(dplyr)
library(stringr)
library(ggalluvial)
library(fmsb)
library(shiny)
library(shinydashboard)
library(DT)
library(fontawesome)
```


```{r importation-donnees, message=FALSE, warning=FALSE}
# Importation des donnÃ©es

player_stats_2021_2022 <- read.csv("data/2021-2022 Football Player Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2021_2022 <- read.csv("data/2021-2022 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2022_2023 <- read.csv("data/2022-2023 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
transfers_2022 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "ISO-8859-1")
```


```{r}
# Traduction des postes 
transfers_2022 <- transfers_2022 %>%
  mutate(position = str_trim(position)) %>%
  mutate(position = recode(position,
    "Centre-Forward" = "Attaquant",
    "Second Striker" = "Attaquant",
    "Forward Attacker" = "Attaquant",
    "attack" = "Attaquant",

    "Right Winger" = "Ailier droit",
    "Right Midfield" = "Ailier droit",

    "Left Winger" = "Ailier gauche",
    "Left Midfield" = "Ailier gauche",

    "Attacking Midfield" = "Milieu offensif",
    "Defensive Midfield" = "Milieu dÃ©fensif",
    "Central Midfield" = "Milieu central",

    "Centre-Back" = "DÃ©fenseur central",
    "defence" = "DÃ©fenseur central",
    "Left-Back" = "DÃ©fenseur gauche",
    "Right-Back" = "DÃ©fenseur droit",

    "Goalkeeper" = "Gardien de but",

    .default = "Autre"
  ))

```

---

### **Question 1 : Quels clubs ont le plus recrutÃ© par poste (top 20) ?**

#### ğŸ¯ Objectif:
Identifier les **20 clubs les plus actifs** lors du mercato dâ€™Ã©tÃ© 2022 en termes de nombre de recrues, puis visualiser quels postes ont Ã©tÃ© ciblÃ©s en prioritÃ© par ces clubs. Cela permet de mieux comprendre les **stratÃ©gies de renforcement** des effectifs selon les lignes de jeu (dÃ©fense, milieu, attaque).

#### ğŸ§ª HypothÃ¨se :
Nous supposons que les clubs ayant terminÃ© en bas de classement ou nouvellement promus ont davantage recrutÃ©, notamment en dÃ©fense et au milieu, dans une logique de **renforcement pour assurer le maintien**. Ã€ lâ€™inverse, les clubs plus stables ou ambitieux auraient fait un recrutement plus ciblÃ© et rÃ©parti entre les lignes.



```{r message=FALSE}
# Code
#pr bien lire les accent on met en UTF
transfers_2022_q1 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "UTF-8")

# Nettoyage de base
transfers_clean <- transfers_2022_q1 %>%
  filter(!is.na(club_to), !is.na(position), position != "")

# Regrouper et compter
recrutements_par_poste <- transfers_clean %>%
  group_by(club_to, position) %>%
  summarise(nb_recrues = n(), .groups = "drop")

# Garder uniquement les 20 clubs ayant recrutÃ© le plus globalement
top_clubs <- recrutements_par_poste %>%
  group_by(club_to) %>%
  summarise(total_recrues = sum(nb_recrues)) %>%
  top_n(20, total_recrues) %>%
  pull(club_to)

# Filtrer les donnÃ©es
recrutements_top <- recrutements_par_poste %>%
  filter(club_to %in% top_clubs)

# Visualisation 
ggplot(recrutements_top, aes(x = position, y = fct_reorder(club_to, nb_recrues), fill = nb_recrues)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Top 20 clubs â€“ nombre de recrues par poste (Ã©tÃ© 2022)",
    x = "Poste",
    y = "Club",
    fill = "Nombre de recrues"
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ **US Salernitana 1919**, un club ayant luttÃ© pour le maintien en Serie A, est celui qui a le plus recrutÃ© tous postes confondus, avec un **focus important sur les milieux offensifs** et **dÃ©fenseurs centraux**. Cela **confirme notre hypothÃ¨se**.

- ğŸ”µ Dâ€™autres clubs comme **US Lecce**, **US Cremonese** et **Udinese Calcio**, Ã©galement engagÃ©s dans la lutte pour le maintien, prÃ©sentent aussi une stratÃ©gie de **renforcement dÃ©fensif**, particuliÃ¨rement au poste de **centre-back**.

- ğŸ”µ En revanche, certains clubs comme **Olympique de Marseille** ou **Nottingham Forest**, pourtant positionnÃ©s plus haut (ou avec de grandes ambitions), ont **diversifiÃ© leurs recrutements** sur plusieurs lignes, ce qui nuance lâ€™hypothÃ¨se. Cela peut reflÃ©ter une stratÃ©gie de **reconstruction dâ€™effectif** ou de prÃ©paration Ã  des compÃ©titions europÃ©ennes.

- ğŸ”µ On observe une **forte demande en milieux de terrain**, avec une concentration sur les postes de *milieu central*, *dÃ©fensif* et *offensif*, ce qui correspond bien Ã  lâ€™idÃ©e que la maÃ®trise du milieu de terrain reste cruciale dans le football moderne.

- Peu de clubs ont recrutÃ© plusieurs **gardiens**, ce qui est conforme aux pratiques usuelles : un club ne recrute gÃ©nÃ©ralement quâ€™un seul gardien par saison.

- Enfin, certains clubs comme **FC Empoli** ou **OGC Nice** ont adoptÃ© une stratÃ©gie plus Ã©quilibrÃ©e, en recrutant sur plusieurs lignes, ce qui peut traduire un **renouvellement global** plutÃ´t quâ€™un ajustement spÃ©cifique.

âœ… **Conclusion** : lâ€™hypothÃ¨se est **globalement confirmÃ©e** â€“ les clubs les moins bien classÃ©s ont recrutÃ© plus, notamment en dÃ©fense. Toutefois, des exceptions existent, liÃ©es Ã  des objectifs plus stratÃ©giques ou spÃ©cifiques (comme lâ€™Europe ou le changement dâ€™entraÃ®neur).


---

### **Question 2: Quels postes sont les plus valorisÃ©s sur le marchÃ© ?**


#### ğŸ¯ Objectif:
Visualiser la valeur marchande des joueurs par poste pour comprendre quels types de profils sont les plus prisÃ©s financiÃ¨rement sur le marchÃ©. Cela permet de hiÃ©rarchiser les postes selon leur importance Ã©conomique dans le football professionnel, sur la base du mercato dâ€™Ã©tÃ© 2022.

#### ğŸ§ª HypothÃ¨se :
Nous pensons que les **attaquants** seront les plus valorisÃ©s sur le marchÃ©, en raison de leur impact direct sur les rÃ©sultats et leur potentiel marketing. Les **dÃ©fenseurs centraux** et **milieux offensifs** devraient aussi avoir une valeur Ã©levÃ©e. Ã€ l'inverse, les **gardiens** devraient Ãªtre en bas de lâ€™Ã©chelle.


```{r message=FALSE}

# Nettoyage et prÃ©paration des donnÃ©es de transfert
transfers_clean <- transfers_2022 %>%
  filter(!is.na(position), !is.na(market_value)) %>%
  distinct(name, position, age, .keep_all = TRUE) %>%
  mutate(
    market_value = gsub("[^0-9\\.]", "", market_value), 
    market_value_num = as.numeric(market_value)
  ) %>%
  filter(market_value_num >= 1.5)

# Calcul de la moyenne et de l'Ã©cart-type des valeurs marchandes par poste
transfers_clean_stats <- transfers_clean %>%
  group_by(position) %>%
  filter(n() >= 5) %>%
  summarise(
    mean_value = mean(market_value_num, na.rm = TRUE),
    sd_value = sd(market_value_num, na.rm = TRUE)
  )

# Visualisation avec titres en franÃ§ais
ggplot(transfers_clean_stats, aes(x = reorder(position, mean_value), y = mean_value)) +
  geom_bar(stat = "identity", fill = "#4CAF50") +  
  geom_errorbar(aes(ymin = pmax(mean_value - sd_value, 0), ymax = mean_value + sd_value), width = 0.2) +
  labs(
    title = "Valeur marchande moyenne par poste (mercato Ã©tÃ© 2022)",
    x = "Poste (en anglais)",
    y = "Valeur marchande moyenne (en millions d'euros)"
  ) +
  theme_minimal(base_size = 12) +
  coord_flip()


```


#### ğŸ§  InterprÃ©tation du graphique :

Ce graphique combine deux informations importantes :

- les barres vertes indiquent la valeur marchande moyenne des joueurs par poste ;

- les barres noires (barres dâ€™erreur) reprÃ©sentent lâ€™Ã©cart-type, câ€™est-Ã -dire la variabilitÃ© des valeurs selon les profils.

- ğŸ”µ Les attaquants sont effectivement les plus valorisÃ©s, avec une moyenne nettement supÃ©rieure. Cela confirme leur rÃ´le stratÃ©gique et commercial. Leur forte variabilitÃ© montre que certains sont recrutÃ©s Ã  prix trÃ¨s Ã©levÃ©, tirant la moyenne vers le haut.

- ğŸ”µ Les dÃ©fenseurs centraux arrivent en seconde position, avec une valeur moyenne Ã©levÃ©e et une dispersion plus contenue, signe dâ€™une reconnaissance stable de leur importance.

- ğŸ”µ Les ailiers droits et gauches prÃ©sentent aussi des valeurs Ã©levÃ©es, ce qui reflÃ¨te la raretÃ© de certains profils trÃ¨s recherchÃ©s (notamment les ailiers gauchers jouant Ã  droite).

- ğŸ”µ Les milieux offensifs sont un peu moins valorisÃ©s que prÃ©vu, et affichent une grande hÃ©tÃ©rogÃ©nÃ©itÃ© : cela suggÃ¨re une disparitÃ© importante entre quelques stars trÃ¨s coÃ»teuses et dâ€™autres profils plus modestes.

- ğŸ”µ Les gardiens sont les moins valorisÃ©s, avec une moyenne basse et une variabilitÃ© plus rÃ©duite, ce qui traduit leur statut secondaire sur le marchÃ©.

âœ… Conclusion : Lâ€™hypothÃ¨se est largement confirmÃ©e. Les attaquants et dÃ©fenseurs centraux dominent en valeur. Lâ€™ajout des barres dâ€™erreur rÃ©vÃ¨le aussi des disparitÃ©s fortes sur certains postes, notamment offensifs, ce qui enrichit lâ€™analyse au-delÃ  des moyennes seules.


---


### **Question 3 : CorrÃ©lation entre xG (expected goals) et points ?**

#### ğŸ¯ Objectif:
Analyser si le nombre dâ€™expected goals (xG) rÃ©alisÃ©s par une Ã©quipe est corrÃ©lÃ© avec son total de points en championnat. Cela permet de vÃ©rifier si produire beaucoup dâ€™occasions de qualitÃ© est un bon indicateur de performance globale. Les expected goals (xG) mesurent la probabilitÃ© quâ€™un tir se transforme en but, en fonction de facteurs comme la position du tir, le type dâ€™action, lâ€™angle de tir ou la pression dÃ©fensive. En somme, plus une Ã©quipe cumule dâ€™xG, plus elle est censÃ©e marquer. DonnÃ©es utilisÃ©es : saison 2022-2023.

#### ğŸ§ª HypothÃ¨se :
Nous pensons quâ€™il existe une **corrÃ©lation positive significative** entre les xG et le total de points. Une Ã©quipe qui se crÃ©e beaucoup dâ€™occasions de qualitÃ© a plus de chances de gagner des matchs, mÃªme si la finition varie.


```{r message=FALSE}
team_stats_22_23 <- team_stats_2022_2023 %>%
  select(Squad, xG, Pts) %>%
  filter(!is.na(xG), !is.na(Pts))

ggplot(team_stats_22_23, aes(x = xG, y = Pts)) +
  geom_point(color = "#1f77b4", size = 3) +
  geom_smooth(method = "lm", color = "red", linetype = "dashed", se = TRUE) +  # se = TRUE pour afficher l'intervalle
  labs(
    title = "CorrÃ©lation entre Expected Goals (xG) et Points en championnat(2022-23)",
    x = "Expected Goals (xG)",
    y = "Points"
  ) +
  theme_minimal(base_size = 12)


```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le nuage de points prÃ©sente une **tendance linÃ©aire positive** entre les xG et les points, confirmÃ©e par la droite de rÃ©gression.

- ğŸ”µ Cela suggÃ¨re que les Ã©quipes qui se crÃ©ent beaucoup dâ€™occasions obtiennent en gÃ©nÃ©ral plus de points, ce qui **valide notre hypothÃ¨se**.

- ğŸ”µ Certaines Ã©quipes dÃ©vient de la tendance (sous-performance ou efficacitÃ© maximale), ce qui montre que les xG ne suffisent pas Ã  eux seuls Ã  expliquer les rÃ©sultats.

âœ… **Conclusion** : Lâ€™hypothÃ¨se est **confirmÃ©e**. Il existe une forte corrÃ©lation entre production offensive (xG) et performance en championnat.

---

### **Question 4 : Quel est l'impact des transferts sur la performance des clubs entre 2021-2022 et 2022-2023 ?**

#### ğŸ¯ Objectif:
Analyser l'Ã©volution de la performance des clubs entre deux saisons (2021-2022 â” 2022-2023) en fonction de leur nombre de recrues durant l'Ã©tÃ© 2022. Lâ€™objectif est de voir sâ€™il existe une corrÃ©lation entre le volume de recrutement et lâ€™Ã©volution du classement.

#### ğŸ§ª HypothÃ¨se :
Nous pensons que les clubs ayant recrutÃ© **modÃ©rÃ©ment (4 Ã  6 joueurs)** progresseront davantage, car ils auront ciblÃ© leurs besoins. Ceux qui ont **recrutÃ© massivement** risquent dâ€™avoir des rÃ©sultats plus hÃ©tÃ©rogÃ¨nes Ã  cause du manque de cohÃ©sion. Les clubs **nâ€™ayant pas recrutÃ©** pourraient stagner ou rÃ©gresser.



```{r message=FALSE}

# Regrouper les clubs qui ont recrutÃ© et compter
nb_recrues_club <- transfers_clean %>%
  group_by(club_to) %>%
  summarise(nb_recrues = n(), .groups = "drop")

# PrÃ©parer les classements par saison
classements_2021_2022 <- team_stats_2021_2022 %>%
  select(Squad, LgRk) %>%
  rename(club = Squad, classement_2022 = LgRk)

classements_2022_2023 <- team_stats_2022_2023 %>%
  select(Squad, LgRk) %>%
  rename(club = Squad, classement_2023 = LgRk)

# Fusionner tout ensemble
evolution_clubs <- classements_2021_2022 %>%
  inner_join(classements_2022_2023, by = "club") %>%
  left_join(nb_recrues_club, by = c("club" = "club_to")) %>%
  mutate(
    nb_recrues = replace_na(nb_recrues, 0),  # certains clubs peuvent avoir 0 recrutement
    evolution_classement = classement_2022 - classement_2023
  ) %>%
  mutate(
    categorie_recrutement = case_when(
      nb_recrues == 0 ~ "0 recrue",
      nb_recrues <= 3 ~ "1-3 recrues",
      nb_recrues <= 6 ~ "4-6 recrues",
      TRUE ~ "7+ recrues"
    )
  )

# Visualisation : boxplot avec palette corrigÃ©e
ggplot(evolution_clubs, aes(x = categorie_recrutement, y = evolution_classement, fill = categorie_recrutement)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_manual(
    values = c(
      "0 recrue" = "#f8766d",        
      "1-3 recrues" = "#f1c40f",     
      "4-6 recrues" = "#2ecc71",    
      "7+ recrues" = "#3498db"      
    )
  ) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  labs(
    title = "Impact du recrutement sur l'Ã©volution du classement (2021-2023)",
    subtitle = "Distribution de l'Ã©volution de position en fonction du nombre de recrues estivales",
    x = "Nombre de recrues (catÃ©gories)",
    y = "Ã‰volution du classement (positif = amÃ©lioration)",
    fill = "Recrutements"
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "right")


```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Les clubs nâ€™ayant recrutÃ© aucun joueur prÃ©sentent des rÃ©sultats trÃ¨s variables, avec une mÃ©diane proche de zÃ©ro. Cela suggÃ¨re quâ€™en lâ€™absence de renfort, il est difficile de progresser de maniÃ¨re structurÃ©e, et que la stabilitÃ© seule ne suffit pas toujours.

- ğŸ”µ Les clubs ayant recrutÃ© entre 1 et 3 joueurs semblent en lÃ©gÃ¨re rÃ©gression. Ce type de recrutement limitÃ© peut reflÃ©ter un ajustement insuffisant face aux besoins de lâ€™effectif.

- ğŸ”µ En revanche, les clubs ayant recrutÃ© entre 4 et 6 joueurs enregistrent en moyenne une amÃ©lioration de leur classement. Cela semble indiquer quâ€™un renforcement ciblÃ©, sans bouleverser lâ€™Ã©quilibre collectif, est plus efficace.

- ğŸ”µ Ã€ lâ€™opposÃ©, les clubs ayant recrutÃ© 7 joueurs ou plus affichent une mÃ©diane nÃ©gative et une forte dispersion des rÃ©sultats. Cela peut sâ€™expliquer par une perte de repÃ¨res au sein du groupe : remplacer trop de joueurs Ã  la fois nuit Ã  la cohÃ©sion et impose de reconstruire lâ€™esprit dâ€™Ã©quipe, ce qui peut ralentir les performances sportives.

âœ… **Conclusion** : Lâ€™hypothÃ¨se est **largement confirmÃ©e** : un recrutement ciblÃ© et mesurÃ© semble plus bÃ©nÃ©fique quâ€™un mercato massif ou une inaction.

---


### **Question 5 : Quels sont les transferts les plus coÃ»teux de lâ€™Ã©tÃ© 2022 ? **

#### ğŸ¯ Objectif: 
Identifier les joueurs ayant fait lâ€™objet des transferts les plus onÃ©reux durant le mercato estival 2022, afin de mieux comprendre oÃ¹ se concentrent les plus gros investissements du marchÃ©.


#### ğŸ§ª HypothÃ¨se :
Les attaquants et les jeunes espoirs prometteurs devraient constituer la majoritÃ© des transferts les plus chers, notamment en direction des grands clubs europÃ©ens.



```{r}

transfers_2022_q5 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "UTF-8")

# Nettoyage des montants
transferts_top <- transfers_2022_q5 %>%
  filter(!is.na(fee)) %>%
  mutate(fee_num = str_extract(fee, "[0-9,.]+"),
         fee_num = as.numeric(gsub(",", ".", fee_num))) %>%
  filter(!is.na(fee_num)) %>%
  arrange(desc(fee_num)) %>%
  distinct(name, .keep_all = TRUE) %>%
  slice_max(fee_num, n = 15)


# Graphique
ggplot(transferts_top, aes(x = reorder(name, fee_num), y = fee_num)) +
  geom_col(fill = "#1f77b4") +
  coord_flip() +
  labs(
    title = "Top 15 des transferts les plus chers â€“ Ã‰tÃ© 2022",
    x = "Joueur",
    y = "Montant du transfert (en millions â‚¬)"
  ) +
  theme_minimal(base_size = 12)

```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le graphique met en Ã©vidence les 15 plus grosses transactions du mercato dâ€™Ã©tÃ© 2022.

- ğŸ”µ Une forte majoritÃ© des joueurs sont des profils offensifs : attaquants ou milieux crÃ©atifs.

- ğŸ”µ On retrouve principalement des clubs disposant dâ€™un fort pouvoir dâ€™achat, issus de la Premier League ou des grands championnats europÃ©ens.

- ğŸ”µ Les sommes engagÃ©es confirment lâ€™importance stratÃ©gique de certains postes et le pari sur le potentiel futur des jeunes joueurs.


âœ… **Conclusion** :  Lâ€™hypothÃ¨se est confirmÃ©e. Les plus grosses dÃ©penses concernent surtout des joueurs offensifs ou trÃ¨s jeunes, recrutÃ©s par des clubs ambitieux financiÃ¨rement. Cela illustre la concentration des investissements sur des profils Ã  fort impact ou Ã  forte valeur de revente.

---

### **Question 6 : Quelle part des buts est marquÃ©e par des recrues (top 10) **

#### ğŸ¯ Objectif:
Mesurer la contribution directe des joueurs recrutÃ©s Ã  lâ€™Ã©tÃ© 2022 dans le total des buts marquÃ©s par leur club en 2022-2023.

#### ğŸ§ª HypothÃ¨se :
Les recrues, devraient reprÃ©senter une part importante des buts dans les clubs ayant beaucoup investi.



```{r}
# Nettoyage des donnÃ©es de transfert
transfers_cleaned <- transfers_2022 %>%
  filter(!is.na(club_to), !is.na(name)) %>%
  distinct(name, club_to)

# Nettoyage et regroupement des joueurs recrutÃ©s
recrues_stats <- player_stats_2021_2022 %>%
  rename(name = Player, club = Squad, buts = Goals, minutes = Min) %>%
  mutate(name = str_trim(name)) %>%
  inner_join(transfers_cleaned, by = "name") %>%
  filter(!is.na(buts)) %>%
  group_by(club_to) %>%
  summarise(buts_recrues = sum(as.numeric(buts), na.rm = TRUE), .groups = "drop")

# Buts totaux par club (2022-2023)
buts_totaux <- team_stats_2022_2023 %>%
  rename(club = Squad) %>%
  select(club, GF)

# Fusion des datasets
part_buts <- buts_totaux %>%
  left_join(recrues_stats, by = c("club" = "club_to")) %>%
  mutate(
    buts_recrues = replace_na(buts_recrues, 0),
    part_recrues = buts_recrues / GF
  ) %>%
  filter(GF > 0, part_recrues > 0) %>% # on garde uniquement les clubs actifs
  arrange(desc(part_recrues)) %>%
  slice_max(part_recrues, n = 10)

# Visualisation en barres horizontales
ggplot(part_buts, aes(x = reorder(club, part_recrues), y = part_recrues)) +
  geom_col(fill = "#0072B2") +
  coord_flip() +
  scale_y_continuous(labels = percent_format(accuracy = 1)) +
  labs(
    title = "Part des buts marquÃ©s par des recrues (Top 10 clubs)",
    x = "Club",
    y = "Part des buts (%)"
  ) +
  theme_minimal(base_size = 12)
```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le graphique met en valeur les 10 clubs oÃ¹ les recrues ont contribuÃ© de maniÃ¨re significative au total des buts.

- ğŸ”µ Cela confirme lâ€™impact potentiel des nouveaux joueurs sur le rendement offensif dâ€™une Ã©quipe, surtout en cas de bonne intÃ©gration.

âœ… **Conclusion** :  Lâ€™hypothÃ¨se est partiellement confirmÃ©e. Dans certains clubs, les recrues ont Ã©tÃ© dÃ©terminantes offensivement. Dans dâ€™autres, leur impact a Ã©tÃ© plus indirect. La contribution dÃ©pend donc fortement du profil des joueurs recrutÃ©s et du besoin tactique identifiÃ©.



---

### **Question 7 : Quel est le rendement des recrues vs anciens **

#### ğŸ¯ Objectif:
Comparer lâ€™efficacitÃ© offensive des recrues vs les joueurs dÃ©jÃ  prÃ©sents.



#### ğŸ§ª HypothÃ¨se :
Les joueurs dÃ©jÃ  intÃ©grÃ©s au collectif devraient avoir un meilleur rendement offensif, car les recrues ont souvent besoin de temps pour sâ€™adapter.


```{r}
# Liste des recrues (nom + club)
recrues <- transfers_2022 %>%
  filter(!is.na(name)) %>%
  distinct(name) %>%
  mutate(statut = "Recrue")

# DonnÃ©es joueurs avec efficacitÃ© offensive
rendement_joueurs <- player_stats_2021_2022 %>%
  rename(name = Player, buts = Goals, minutes = Min) %>%
  mutate(name = str_trim(name),
         buts = as.numeric(buts),
         minutes = as.numeric(minutes),
         rendement = buts / minutes) %>%
  filter(!is.na(rendement), minutes > 200) %>%
  mutate(statut = ifelse(name %in% recrues$name, "Recrue", "DÃ©jÃ  prÃ©sent"))

# Visualisation : violin plot du rendement
ggplot(rendement_joueurs, aes(x = statut, y = rendement, fill = statut)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.1, color = "black", outlier.shape = NA) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  labs(
    title = "Rendement offensif : Recrues vs Joueurs dÃ©jÃ  prÃ©sents",
    x = "",
    y = "Buts par minute jouÃ©e"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none")
```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ La forme du violin plot montre la distribution complÃ¨te du rendement offensif.

- ğŸ”µ Les joueurs dÃ©jÃ  prÃ©sents prÃ©sentent une distribution plus homogÃ¨ne et une mÃ©diane plus Ã©levÃ©e.

- ğŸ”µ Les recrues ont un rendement plus variable : certains trÃ¨s efficaces, mais aussi de nombreux cas en dessous de la mÃ©diane des anciens.

âœ… **Conclusion** :  Lâ€™hypothÃ¨se est globalement confirmÃ©e. Les joueurs dÃ©jÃ  prÃ©sents affichent un meilleur rendement moyen que les recrues, ce qui reflÃ¨te sans doute une meilleure adaptation au systÃ¨me de jeu. Cependant, certaines recrues affichent des performances remarquables, ce qui montre leur potentiel une fois intÃ©grÃ©es.

---

### **Question 8 : Recrutement local vs international? (top 15)**

#### ğŸ¯ Objectif:
Visualiser la rÃ©partition gÃ©ographique du top 15 des recrutements pour Ã©valuer dans quelle mesure les clubs recrutent localement ou Ã  lâ€™international.

#### ğŸ§ª HypothÃ¨se :
Les grands clubs europÃ©ens recrutent principalement Ã  lâ€™international, tandis que les clubs de second rang privilÃ©gient les transferts nationaux pour des raisons de coÃ»t et de logistique.


```{r}
# Identifier les 15 pays qui ont recrutÃ© le plus
top_pays <- transfers_2022 %>%
  filter(!is.na(country_to)) %>%
  count(country_to, name = "nb_total") %>%
  top_n(15, nb_total) %>%
  pull(country_to)

# PrÃ©parer les donnÃ©es filtrÃ©es
transfers_local_vs_intl <- transfers_2022 %>%
  filter(!is.na(country_from), !is.na(country_to)) %>%
  mutate(type = ifelse(country_from == country_to, "National", "International")) %>%
  count(country_to, type, name = "nb_transferts") %>%
  filter(country_to %in% top_pays)

# Barplot groupÃ© 
ggplot(transfers_local_vs_intl, aes(x = reorder(country_to, -nb_transferts), y = nb_transferts, fill = type)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Recrutements nationaux vs internationaux (Top 15 pays â€“ Ã©tÃ© 2022)",
    x = "Pays de destination",
    y = "Nombre de transferts",
    fill = "Type de transfert"
  ) +
  theme_minimal(base_size = 13) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Certains pays comme lâ€™Allemagne ou lâ€™Espagne ont un bon Ã©quilibre entre local et international.

- ğŸ”µ Les clubs des championnats secondaires recrutent davantage localement, contrairement aux clubs anglais ou italiens.


âœ… **Conclusion** :  Lâ€™hypothÃ¨se est confirmÃ©e. Le recrutement international est prÃ©pondÃ©rant dans les grands championnats, mais des flux internes nationaux importants subsistent dans certains pays. La carte des transferts illustre une gÃ©opolitique du football bien ancrÃ©e.

---

### **Question 9 : Quels clubs misent sur des jeunes joueurs ?**

#### ğŸ¯ Objectif:

Identifier les clubs qui intÃ¨grent le plus de jeunes joueurs dans leur effectif et leur donnent du temps de jeu.

#### ğŸ§ª HypothÃ¨se :

Certains clubs, notamment ceux ayant une stratÃ©gie axÃ©e sur la formation ou la revente de joueurs (comme RB Salzburg, l'Ajax ou Barcelone), misent davantage sur les jeunes talents, tant en nombre quâ€™en minutes jouÃ©es. On peut Ã©galement sâ€™attendre Ã  observer une forte prÃ©sence de jeunes joueurs dans les clubs des championnats franÃ§ais et espagnol, ces pays disposant de viviers de talents particuliÃ¨rement importants et n'hÃ©site pas Ã  former de jeunes joueurs. Par ailleurs, les clubs disposant de moyens financiers plus limitÃ©s ont souvent tendance Ã  faire davantage confiance aux jeunes joueurs, qui reprÃ©sentent une alternative plus Ã©conomique

```{r}

# Filtrer les jeunes joueurs 
jeunes_joueurs <- player_stats_2021_2022  %>%
  filter(Age < 22)

# Compter le nombre de jeunes joueurs par club
jeunes_par_club <- jeunes_joueurs %>%
  count(Squad, name = "nb_jeunes") %>%
  arrange(desc(nb_jeunes)) %>%
  top_n(10, nb_jeunes)

# Barplot horizontal
ggplot(jeunes_par_club, aes(x = reorder(Squad, nb_jeunes), y = nb_jeunes)) +
  geom_col(fill = "#66BB6A", width = 0.6) +  
  geom_text(aes(label = nb_jeunes), hjust = -0.1, size = 4, color = "black") +
  coord_flip(clip = "off") +
  labs(
    title = "Top 10 des clubs avec le plus de jeunes joueurs (< 22 ans)\nSaison 2021/22",
    x = NULL,
    y = "Nombre de jeunes joueurs"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    axis.text.y = element_text(face = "bold"),
    axis.text.x = element_text(color = "gray30"),
    panel.grid.major.y = element_blank(),  
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 20, 10, 10) 
  ) +
  ylim(0, max(jeunes_par_club$nb_jeunes) + 2)  

```

```{r}
# Filtrer les jeunes joueurs (<23 ans)
jeunes_joueurs <- player_stats_2021_2022 %>%
  filter(Age < 23)

# Calculer le total des minutes jouÃ©es par club (par les jeunes joueurs)
minutes_par_club <- jeunes_joueurs %>%
  group_by(Squad) %>%
  summarise(total_minutes = sum(Min, na.rm = TRUE)) %>%
  arrange(desc(total_minutes)) %>%
  slice_head(n = 10)  # Top 10 clubs

# Lollipop plot
ggplot(minutes_par_club, aes(x = reorder(Squad, total_minutes), y = total_minutes)) +
  geom_segment(aes(xend = Squad, y = 0, yend = total_minutes), color = "#4CAF50", size = 1.2) +
  geom_point(color = "#FBC02D", size = 6) +
  coord_flip() +
  labs(
    title = "Total des minutes jouÃ©es par les jeunes joueurs\npar club sur la saison 2021/22",
    x = "Club",
    y = "Minutes jouÃ©es"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_blank()
  )


```

#### ğŸ§  InterprÃ©tation des graphiques:


- ğŸ”µ Certains clubs rÃ©putÃ©s pour leur formation â€” **FC Barcelone**, **Borussia Dortmund**, **Bayer Leverkusen** â€” offrent un temps de jeu consÃ©quent Ã  leurs jeunes joueurs.

- ğŸ”µ La **Ligue 1** se distingue nettement : **6 clubs dans le top 15** en nombre de jeunes joueurs utilisÃ©s, **4 dans le top 10** en minutes jouÃ©es. Cela confirme une forte culture de formation et une intÃ©gration rapide des jeunes dans les effectifs.

- ğŸ”µ La **Liga espagnole** est moins reprÃ©sentÃ©e que prÃ©vu, avec seulement deux clubs dans le top 15. Le **FC Barcelone** reste une exception forte, incarnant une politique claire de valorisation interne.

- ğŸ”µ Certains clubs comme **Reims**, **Bologne** ou **Valence** allient jeunesse de lâ€™effectif et temps de jeu Ã©levÃ© pour ces joueurs, confirmant une stratÃ©gie de dÃ©veloppement assumÃ©e.

- ğŸ”µ Aucun lien direct nâ€™Ã©merge entre le **budget** et lâ€™**utilisation des jeunes** : mÃªme les clubs les plus riches (**PSG**, **Milan AC**, **BarÃ§a**) misent fortement sur leur centre de formation. Cela montre que la formation est un levier stratÃ©gique, au-delÃ  des moyens financiers.



âœ… **Conclusion** :Lâ€™hypothÃ¨se est donc globalement confirmÃ©e : les clubs avec une stratÃ©gie de formation claire jouent davantage leurs jeunes talents, comme en tÃ©moignent les chiffres en nombre de joueurs et en minutes jouÃ©es. Cependant, la diversitÃ© des situations montre que ce nâ€™est pas uniquement une question de moyens financiers, mais surtout dâ€™efficacitÃ© des centres de formation et de la politique sportive adoptÃ©e. Cette analyse souligne donc lâ€™importance de la formation comme facteur clÃ© de succÃ¨s pour les clubs souhaitant valoriser leurs jeunes joueurs sur le long terme

---

### **Question 10 : Quelles Ã©quipes sont les plus "chanceuses" ou "malchanceuses" ? **

#### ğŸ¯ Objectif:
Identifier les Ã©quipes dont le nombre de buts marquÃ©s est significativement supÃ©rieur ou infÃ©rieur Ã  leur expected goals (xG) sur la saison 2021/2022. Cela permet de mettre en Ã©vidence celles qui dÃ©passent les attentes en convertissant efficacement leurs occasions (Ã©quipes Â« chanceuses Â»), et celles qui, malgrÃ© beaucoup dâ€™occasions crÃ©Ã©es (xG Ã©levÃ©), peinent Ã  concrÃ©tiser (Ã©quipes Â« malchanceuses Â»). On ne se basera que sur les grands championnats pour essayer d'Ã©tablir une corrÃ©lation avec la place dans le classement cette annÃ©e la.


#### ğŸ§ª HypothÃ¨se :

Il paraÃ®t plausible que les Ã©quipes les mieux classÃ©es dans leur championnat ont tendance Ã  Ãªtre Â« chanceuses Â», câ€™est-Ã -dire quâ€™elles marquent plus de buts que ce que leur expected goals (xG) prÃ©dit, grÃ¢ce Ã  une meilleure finition et une efficacitÃ© offensive supÃ©rieure. En revanche, les Ã©quipes moins bien classÃ©es que ce qu'elle devrait, malgrÃ© un xG parfois Ã©levÃ©, peinent Ã  convertir leurs occasions, ce qui les rend Â« malchanceuses Â» et reflÃ¨te un manque de rÃ©alisme devant le but ou une qualitÃ© individuelle moindre.



```{r}
# On ajoute une colonne GF - xG (buts rÃ©els moins buts attendus)
team_stats_2021_2022$delta_goals <- team_stats_2021_2022$GF - team_stats_2021_2022$xG

top_chanceuses <- team_stats_2021_2022 %>%
  arrange(desc(delta_goals)) %>%
  slice_head(n = 10)

ggplot(top_chanceuses, aes(x = reorder(Squad, delta_goals), y = delta_goals)) +
  geom_col(fill = "#4CAF50", width = 0.6) +
  coord_flip(clip = "off") + 
  labs(
    title = "Top 10 Ã©quipes 'chanceuses' en 2021/2022",
    subtitle = "Ã‰quipes ayant marquÃ© plus de buts que leurs xG attendus",
    x = "Ã‰quipe",
    y = "DiffÃ©rence buts rÃ©els - xG"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 11, face = "italic"),
    axis.title.x = element_text(face = "bold", size = 10),
    axis.title.y = element_text(face = "bold", size = 11),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 30, 10, 10)
  )




```

```{r}
# Top 10 Ã©quipes "malchanceuses" (delta_goals nÃ©gatif le plus bas)
top_malchanceuses <- team_stats_2021_2022 %>%
  arrange(delta_goals) %>%
  slice_head(n = 10)

ggplot(top_malchanceuses, aes(x = reorder(Squad, delta_goals), y = delta_goals)) +
  geom_col(fill = "#D32F2F", width = 0.6) +
  coord_flip(clip = "off") +
  labs(
    title = "Top 10 Ã©quipes 'malchanceuses' en 2021/2022",
    subtitle = "Ã‰quipes avec un xG Ã©levÃ© mais peu de buts marquÃ©s",
    x = "Ã‰quipe",
    y = "DiffÃ©rence buts rÃ©els - xG"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 11, face = "italic"),
    axis.title.x = element_text(face = "bold", size = 10),
    axis.title.y = element_text(face = "bold", size = 11),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 30, 10, 10)
  )



```

#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Une corrÃ©lation apparaÃ®t entre les Ã©quipes "chanceuses" (ayant marquÃ© plus de buts que leurs xG) et leur performance en championnat.

- ğŸ”µ Parmi ces Ã©quipes : **Dortmund (2áµ‰ Bundesliga)**, **Lazio (5áµ‰ Serie A)**, **Rennes (4áµ‰ Ligue 1)**, **Leverkusen (3áµ‰ Bundesliga)**, **Naples (3áµ‰ Serie A)** et **PSG (champion de Ligue 1)**. Hormis les trÃ¨s grands clubs comme le PSG, ces Ã©quipes ont souvent rÃ©alisÃ© lâ€™une de leurs meilleures saisons.

- ğŸ”µ Des clubs comme **Hellas VÃ©rone (9áµ‰ en Serie A cette saison-lÃ , 17áµ‰ la suivante)** ou **Nantes (9áµ‰ en Ligue 1, contre 18áµ‰ puis 17áµ‰ les saisons encadrantes)** tÃ©moignent Ã©galement de performances supÃ©rieures Ã  leur niveau habituel, suggÃ©rant une **saison de surperformance**.

- ğŸ”µ Ã€ lâ€™inverse, les Ã©quipes "malchanceuses" (xG Ã©levÃ©s mais peu de buts marquÃ©s) sont souvent bien classÃ©es : **Real Sociedad (6áµ‰)**, **Genoa (11áµ‰)**, **Lorient (10áµ‰)**, **Athletic Club (8áµ‰)**, **Clermont (8áµ‰)**, **Rayo Vallecano (12áµ‰)**, **Wolfsburg (12áµ‰)**. Leur bon classement s'explique par une capacitÃ© Ã  se crÃ©er de nombreuses occasions, sans les concrÃ©tiser pleinement.

- ğŸ”µ Enfin, des Ã©quipes comme **Norwich** ou **AlavÃ©s**, derniers de leurs championnats, montrent que la "malchance" ne suffit pas toujours Ã  expliquer les rÃ©sultats : certaines saisons sont simplement ratÃ©es dans leur ensemble.


âœ… **Conclusion** :  

Les Ã©quipes "chanceuses", qui marquent plus que leurs expected goals (xG), sont souvent bien classÃ©es et en surperformance. Ã€ l'inverse, certaines Ã©quipes "malchanceuses" restent compÃ©titives malgrÃ© un manque d'efficacitÃ© offensive. L'Ã©cart entre buts et xG influence le classement, mais ne l'explique pas entiÃ¨rement.

---

### **Question 11 : Les clubs ayant recrutÃ© plus de joueurs ont-ils mieux performÃ© ? **

#### ğŸ¯ Objectif:
Ã‰tudier sâ€™il existe une relation entre le nombre de recrues lors du mercato estival 2022 et lâ€™Ã©volution des performances sportives des clubs entre 2021-2022 et 2022-2023.

#### ğŸ§ª HypothÃ¨se :
Nous formulons lâ€™hypothÃ¨se que chaque dÃ©fenseur excelle dans un type dâ€™intervention dÃ©fensive qui correspond Ã  :son style de jeu personnel,les besoins spÃ©cifiques de son Ã©quipe, ou encore aux caractÃ©ristiques du championnat dans lequel il Ã©volue.
Par exemple, un joueur comme Virgil van Dijk pourrait exceller dans les duels aÃ©riens en raison du rythme physique de la Premier League, tandis que David Alaba aurait un profil plus polyvalent ou technique adaptÃ© au style de jeu du Real Madrid en Liga.


```{r}

# SÃ©lection des joueurs reprÃ©sentatifs par championnat
joueurs <- c("Virgil van Dijk", "Marquinhos", "Kalidou Koulibaly", "David Alaba")

# CrÃ©ation des indicateurs normalisÃ©s par 90 minutes
defenseurs <- player_stats_2021_2022 %>%
  filter(Player %in% joueurs, X90s > 5) %>%
  mutate(
    Tacles90 = Tkl / X90s,
    Interceptions90 = Int / X90s,
    DuelsAerienPct = AerWon.,
    Blocs90 = Blocks / X90s,
    Degagements90 = Clr / X90s
  ) %>%
  select(Player, Tacles90, Interceptions90, DuelsAerienPct, Blocs90, Degagements90) %>%
  column_to_rownames("Player")

# Ajouter lignes max / min pour fmsb
radar_def <- rbind(
  apply(defenseurs, 2, max),
  apply(defenseurs, 2, min),
  defenseurs
)

# Renommer les colonnes pour plus de clartÃ©
colnames(radar_def) <- c(
  "Tacles/90m",
  "Interceptions/90m",
  "Duels aÃ©riens (%)",
  "Blocs/90m",
  "DÃ©gagements/90m"
)

# RÃ©duction des marges et affichage radar
par(mar = c(2, 2, 2, 2))

# Couleurs amÃ©liorÃ©es (Alaba passe en violet foncÃ©)
radarchart(
  radar_def,
  axistype = 1,
  pcol = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"),  # rouge, bleu, vert, violet
  pfcol = c("#E41A1C50", "#377EB850", "#4DAF4A50", "#984EA350"),
  plwd = 2,
  cglcol = "grey",
  cglty = 1,
  axislabcol = "grey",
  vlcex = 0.9,
  title = "Profil dÃ©fensif des meilleurs dÃ©fenseurs par championnat (2021-2022)"
)

legend(
  "topright",
  legend = rownames(defenseurs),
  col = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"),
  lty = 1,
  lwd = 2,
  bty = "n"
)

```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le radar chart permet de comparer les performances de Virgil van Dijk (Premier League), Marquinhos (Ligue 1), Kalidou Koulibaly (Serie A) et David Alaba (La Liga), chacun reprÃ©sentÃ© par une couleur distincte.

- ğŸ”µ Van Dijk domine nettement les duels aÃ©riens, ce qui confirme son rÃ´le de tour de contrÃ´le dÃ©fensive au sein de Liverpool et son importance dans le jeu aÃ©rien.

- ğŸ”µ Marquinhos prÃ©sente un profil trÃ¨s Ã©quilibrÃ©, avec des performances solides sur lâ€™ensemble des dimensions dÃ©fensives, reflÃ©tant sa rÃ©gularitÃ© et sa polyvalence au PSG.

- ğŸ”µ Koulibaly se distingue particuliÃ¨rement par son volume de dÃ©gagements et de blocs, traduisant une approche dÃ©fensive rÃ©active, physique et axÃ©e sur lâ€™interruption du jeu adverse.

- ğŸ”µ Alaba, en revanche, affiche un profil moins basÃ© sur lâ€™impact physique ; ses statistiques reflÃ¨tent davantage son rÃ´le hybride entre dÃ©fenseur et milieu dans un systÃ¨me de possession comme celui du Real Madrid.

âœ… **Conclusion** :  

Cette visualisation met en lumiÃ¨re la diversitÃ© des profils dÃ©fensifs au plus haut niveau europÃ©en. Chaque joueur excelle dans des dimensions diffÃ©rentes, illustrant que la performance dÃ©fensive ne se limite pas Ã  une seule statistique, mais dÃ©pend de lâ€™environnement tactique, du style dâ€™Ã©quipe et du championnat. Le radar chart est ici un outil efficace pour identifier les points forts et les spÃ©cialisations de chacun, tout en offrant une reprÃ©sentation synthÃ©tique dâ€™indicateurs hÃ©tÃ©rogÃ¨nes mais complÃ©mentaires.

---

### **Question 12 : Quels clubs sont les plus dÃ©pendants de leur meilleur buteur ?**

#### ğŸ¯ Objectif: 
Ã‰valuer dans quelle mesure chaque club dÃ©pend de son meilleur buteur pour marquer des buts lors de la saison 2021-2022.



#### ğŸ§ª HypothÃ¨se :
Certains clubs dÃ©pendent fortement dâ€™un seul joueur pour marquer des buts. Cette dÃ©pendance peut poser un risque stratÃ©gique (blessure, transfert, mÃ©forme).



```{r}
# Extraction depuis la colonne unique "Buteur"
team_stats_2021_2022 <- team_stats_2021_2022 %>%
  mutate(
    Nb_buts_buteur = str_extract(Top.Team.Scorer, "\\d+$"),            
    Buteur = str_remove(Top.Team.Scorer, "\\s*-\\s*\\d+$"),             
    Nb_buts_buteur = as.numeric(Nb_buts_buteur),
    dep_buteur = Nb_buts_buteur / GF
  )

# Top 10 des clubs les plus dÃ©pendants
top_dependance <- team_stats_2021_2022 %>%
  filter(!is.na(dep_buteur)) %>%
  arrange(desc(dep_buteur)) %>%
  slice_head(n = 10)

# Visualisation
ggplot(top_dependance, aes(x = reorder(Squad, dep_buteur), y = dep_buteur)) +
  geom_col(fill = "#0072B2") +
  coord_flip() +
  labs(
    title = "Top 10 des clubs les plus dÃ©pendants Ã  leur meilleur buteur (2021-2022)",
    x = "Club",
    y = "Part des buts marquÃ©s par le meilleur buteur"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_minimal()

```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le graphique illustre la part des buts marquÃ©s par le meilleur buteur de chaque club, mettant en Ã©vidence leur dÃ©pendance offensive Ã  un seul joueur.

- ğŸ”µ Getafe est lâ€™Ã©quipe la plus dÃ©pendante, avec prÃ¨s de 48 % de ses buts inscrits par Enes Ãœnal, suivi de Norwich City, dont Teemu Pukki a marquÃ© Ã©galement 48 % des buts du club.

- ğŸ”µ Des clubs comme AlavÃ©s ou Espanyol affichent eux aussi une forte dÃ©pendance offensive, dÃ©passant le seuil de 40 % de buts venant dâ€™un seul joueur.

- ğŸ”µ Ce niveau de concentration du scoring rend ces Ã©quipes vulnÃ©rables : lâ€™absence ou la mÃ©forme de leur buteur principal peut fortement pÃ©naliser leur efficacitÃ© offensive globale.


âœ… **Conclusion** :  
Ce graphique met en Ã©vidence que certains clubs reposent quasiment Ã  moitiÃ© sur un seul joueur pour marquer. Cela suggÃ¨re une dÃ©pendance tactique risquÃ©e, qui devrait Ãªtre prise en compte dans la stratÃ©gie sportive (recrutement, distribution du jeu, etc.).
Ã€ lâ€™inverse, les clubs avec une dÃ©pendance plus faible bÃ©nÃ©ficient dâ€™un jeu offensif plus collectif, souvent plus rÃ©silient Ã  lâ€™Ã©chelle dâ€™une saison.

---

### **Question 13 : Les investissements ont-ils amÃ©liorÃ© les rÃ©sultats sportifs ? **

#### ğŸ¯ Objectif:
Analyser sâ€™il existe une relation entre les montants investis par les clubs pendant le mercato estival 2022 et leur Ã©volution en termes de points entre les saisons 2021-2022 et 2022-2023.


#### ğŸ§ª HypothÃ¨se :
Les clubs ayant dÃ©pensÃ© davantage lors du mercato estival 2022 ont obtenu de meilleurs rÃ©sultats sportifs la saison suivante.

```{r}
# Nettoyage de la variable "fee" (valeur du transfert)
transfers_clean <- transfers_2022 %>%
  filter(!fee %in% c("Free", "Loan", "", NA)) %>%
  mutate(fee = str_remove_all(fee, "â‚¬|m|\\s"),
         fee = as.numeric(fee))  # en millions dâ€™euros

# Calcul des investissements totaux par club dâ€™arrivÃ©e
investissements <- transfers_clean %>%
  group_by(club_to) %>%
  summarise(invest_total = sum(fee, na.rm = TRUE))

# PrÃ©parer la table avec variation de points
variation_points <- team_stats_2022_2023 %>%
  select(Squad, Pts) %>%
  rename(club_to = Squad, Pts_22_23 = Pts) %>%
  left_join(select(team_stats_2021_2022, Squad, Pts), by = c("club_to" = "Squad")) %>%
  rename(Pts_21_22 = Pts) %>%
  mutate(variation_pts = Pts_22_23 - Pts_21_22)

# Fusion des donnÃ©es
df_invest <- left_join(variation_points, investissements, by = "club_to") %>%
  filter(!is.na(invest_total))

# Graphique : rÃ©gression + intervalle de confiance
ggplot(df_invest, aes(x = invest_total, y = variation_pts)) +
  geom_point(size = 3, alpha = 0.7, color = "#E69F00") +
  geom_smooth(
    method = "lm",
    se = TRUE,
    level = 0.50,  
    color = "black",
    fill = "grey70",
    alpha = 0.4,
    linetype = "dashed"
  ) +
  labs(
    title = "Lien entre investissement estival et progression en points",
    x = "Montant investi (en millions â‚¬)",
    y = "Ã‰volution du nombre de points"
  ) +
  theme_minimal()
```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Le graphique met en relation le montant investi par chaque club lors du mercato estival 2022 avec la variation de points obtenue entre les saisons 2021-2022 et 2022-2023.

- ğŸ”µ Chaque point reprÃ©sente un club, avec lâ€™axe horizontal indiquant le montant total investi (en Mâ‚¬), et lâ€™axe vertical montrant lâ€™Ã©volution du nombre de points sur une saison.

- ğŸ”µ La droite de rÃ©gression affiche une lÃ©gÃ¨re pente nÃ©gative, suggÃ©rant quâ€™en moyenne, les clubs les plus dÃ©pensiers nâ€™ont pas forcÃ©ment progressÃ© en termes de rÃ©sultats sportifs.



âœ… **Conclusion** :  

Cette visualisation suggÃ¨re que les investissements Ã©levÃ©s ne se traduisent pas systÃ©matiquement par une amÃ©lioration des rÃ©sultats sportifs.
Au contraire, la tendance observÃ©e dans notre Ã©chantillon montre une corrÃ©lation lÃ©gÃ¨rement nÃ©gative entre les montants investis et la progression en points.
Ce rÃ©sultat met en Ã©vidence que le budget seul ne suffit pas : la qualitÃ© du recrutement, lâ€™intÃ©gration des joueurs, la stratÃ©gie de jeu ou encore la stabilitÃ© de lâ€™effectif peuvent jouer un rÃ´le plus important que la dÃ©pense brute.
---

### **Question 14 : Quels sont les meilleurs milieux de terrain en termes de crÃ©ation ?**

#### ğŸ¯ Objectif:
Identifier les milieux de terrain les plus crÃ©atifs lors de la saison 2021-2022 en combinant plusieurs indicateurs : passes clÃ©s, passes dÃ©cisives, passes dans la surface, et passes menant Ã  des tirs.



#### ğŸ§ª HypothÃ¨se :
Un milieu crÃ©atif ne se limite pas aux passes dÃ©cisives. Les meilleurs crÃ©ateurs sont ceux qui prÃ©parent les occasions, pÃ©nÃ¨trent dans les zones dangereuses et participent activement Ã  la construction offensive.


```{r}
# SÃ©lection des milieux ayant jouÃ© au moins 10 matchs et disponibles dans les bonnes colonnes
milieux <- player_stats_2021_2022 %>%
  filter(Pos %in% c("MF", "CM", "DM", "AM")) %>%
  filter(MP >= 10) %>%
  select(Player, Squad, Pos, MP, Assists, PasAss, PPA, ScaPassLive) %>%
  mutate(note_creation = (Assists + PasAss + PPA + ScaPassLive) / MP) %>%
  arrange(desc(note_creation)) %>%
  slice_head(n = 10)
ggplot(milieux, aes(x = reorder(Player, note_creation), y = note_creation, fill = Squad)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Top 10 des milieux les plus crÃ©atifs (2021-2022)",
    x = "Joueur",
    y = "Indice de crÃ©ation par match"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")

```


#### ğŸ§  InterprÃ©tation du graphique:

- ğŸ”µ Lâ€™indice prÃ©sentÃ© combine quatre dimensions clÃ©s de la crÃ©ation offensive : Assists (passes dÃ©cisives), PasAss (passes clÃ©s), PPA (passes vers la surface), et ScaPassLive (passes en jeu menant Ã  un tir).

- ğŸ”µ En rapportant ces donnÃ©es au nombre de matchs jouÃ©s, on obtient un indice normalisÃ©, ce qui permet une comparaison Ã©quitable entre joueurs, quelle que soit leur durÃ©e de jeu.

- ğŸ”µ Cet indice offre une vision globale de la contribution offensive par la passe, en allant au-delÃ  des seules passes dÃ©cisives pour inclure la prÃ©paration des actions dangereuses.

âœ… **Conclusion** :  

Cette approche met en lumiÃ¨re les milieux les plus impliquÃ©s dans la crÃ©ation offensive, quâ€™ils soient passeurs dÃ©cisifs, rÃ©gulateurs du jeu ou moteurs de la progression du ballon.
Elle montre que la crÃ©ativitÃ© ne se limite pas aux passes dÃ©cisives visibles, mais aussi Ã  la construction dâ€™occasions, essentielle au jeu moderne.

---

### **Question 15 : Volume des transferts par ligue de dÃ©part ** 

#### ğŸ¯ Objectif:
Analyser quel championnat (ligue) est Ã  lâ€™origine du plus grand nombre de transferts durant lâ€™Ã©tÃ© 2022. Cela aide Ã  repÃ©rer les championnats qui forment beaucoup de joueurs ou qui ont une stratÃ©gie de vente active.

#### ğŸ§ª HypothÃ¨se :
Les ligues les plus rÃ©putÃ©es financiÃ¨rement (ex : Premier League, Liga, Bundesliga) exportent plus de joueurs, mais certains championnats moins connus (AmÃ©rique du Sud) peuvent aussi Ãªtre des promoteurs importants de jeunes talents.

#### ğŸ§  InterprÃ©tation du graphique:
Le graphique montre les 15 premiÃ¨res ligues (hors 2e et 3e divisions) classÃ©es selon leur nombre de joueurs transfÃ©rÃ©s.
On remarque que les 5 grands championnats sont en haut du classement comme prÃ©vu mais Ã©tonnemment la ligue turque ou mÃªme la ligue 2 franÃ§aise ont un nombre de transferts plus Ã©levÃ© que la ligue brÃ©silienne. Cela peut provenir du fait qu'Ã  cette annÃ©e il y'a eu manque de talents provenants de ces pays.

```{r}

```


---

### **Question 16 : Valeur marchande des transferts selon pays et ligue de dÃ©part**

#### ğŸ¯ Objectif:
Analyser la rÃ©partition de la valeur totale des transferts selon le pays et la ligue dâ€™origine des joueurs. Cela permet de mieux comprendre oÃ¹ les clubs arrivent Ã  faire de bons retour sur investissement et dâ€™identifier les marchÃ©s les plus chers.

#### ğŸ§ª HypothÃ¨se :
Les pays et ligues les plus riches ou les plus attractifs devraient gÃ©nÃ©rer des transferts avec des valeurs plus Ã©levÃ©es. On sâ€™attend donc Ã  une concentration forte sur quelques ligues majeures (le top 5 ligues europÃ©ennes).


```{r}

```


#### ğŸ§  InterprÃ©tation du graphique:
- ğŸ”µ Le graphique illustre clairement que certaines ligues et pays (comme Ã©noncÃ© dans l'hypothÃ¨se, le top 5 ligues Euro) dominent le marchÃ© par la valeur financiÃ¨re des transferts.

- ğŸ”µ Lâ€™Ã©chelle logarithmique permet de bien voir les diffÃ©rences entre ligues majeures et mineures.

- ğŸ”µ La table dÃ©taille les valeurs prÃ©cises, facilitant les comparaisons.


âœ… **Conclusion** :  
Les investissements sont concentrÃ©s dans un petit nombre de ligues majeures, confirmant lâ€™hypothÃ¨se. Cette analyse financiÃ¨re complÃ¨te lâ€™analyse quantitative du volume des transferts. Cela confirme que les grands championnats ont un pouvoir de nÃ©gociation bien plus fort. On voit aussi que la valeur dâ€™un joueur ne dÃ©pend pas uniquement de son talent, mais aussi de son championnat dâ€™origine et de sa visibilitÃ© mÃ©diatique.


---

### **Question 17 : **

#### ğŸ¯ Objectif:


#### ğŸ§ª HypothÃ¨se :



```{r}

```


#### ğŸ§  InterprÃ©tation du graphique:


âœ… **Conclusion** :  

---

### **Question 18 : **

#### ğŸ¯ Objectif:


#### ğŸ§ª HypothÃ¨se :



```{r}

```


#### ğŸ§  InterprÃ©tation du graphique:


âœ… **Conclusion** :  

---

### **Question 19 : **

#### ğŸ¯ Objectif:


#### ğŸ§ª HypothÃ¨se :



```{r}

```


#### ğŸ§  InterprÃ©tation du graphique:


âœ… **Conclusion** :  

---

### **Question 20 : **

#### ğŸ¯ Objectif:


#### ğŸ§ª HypothÃ¨se :



```{r}

```


#### ğŸ§  InterprÃ©tation du graphique:


âœ… **Conclusion** :  



