---
title: "Rapport"
author: "Ahamad MOHAMMAD; Minko Bikono NEIL-JOVY; Simon GELBART; Willen AMICHE"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
---


## **Introduction**

Notre objectif est d‚Äôexplorer l‚Äôimpact des strat√©gies de recrutement sur les performances sportives des clubs et joueurs. En combinant des statistiques individuelles, collectives et des donn√©es de transferts, nous chercherons √† identifier les tendances qui influencent la r√©ussite des √©quipes sur plusieurs saisons. 


### **üìä Description des variables**

#### - üßç‚Äç‚ôÇÔ∏è Player Stats 2021-2022 (`2021-2022 Football Player Stats.csv`)

143 variables ‚Äì chaque ligne correspond √† un joueur pour la saison 2021-2022.

| Variable          | Type      | Description approximative |
|-------------------|-----------|----------------------------|
| `Rk`              | int64     | Rang ou ID du joueur       |
| `Player`          | object    | Nom du joueur              |
| `Nation`          | object    | Nationalit√©                |
| `Pos`             | object    | Poste                      |
| `Squad`           | object    | Club                       |
| `Comp`            | object    | Comp√©tition principale     |
| `Age`             | object    | √Çge                        |
| `Born`            | object    | Ann√©e de naissance         |
| ...               | ...       | ...et plus de 130 autres statistiques de jeu : buts, passes, tirs, dribbles, fautes, tacles, interceptions, passes progressives, etc. |
| `AerWon`          | float64   | Duels a√©riens gagn√©s       |
| `AerLost`         | float64   | Duels a√©riens perdus       |
| `AerWon%`         | float64   | Pourcentage de duels a√©riens gagn√©s |

---

#### - üèüÔ∏è Team Stats 2021-2022 (`2021-2022 Football Team Stats.csv`)

20 variables ‚Äì chaque ligne correspond √† une √©quipe.

| Variable          | Type      | Description |
|------------------|-----------|-------------|
| `Rk`             | int64     | Rang        |
| `Squad`          | object    | Nom du club |
| `Country`        | object    | Pays        |
| `LgRk`           | int64     | Classement dans la ligue |
| `MP`, `W`, `D`, `L` | int64  | Matchs jou√©s, Victoires, Nuls, D√©faites |
| `GF`, `GA`, `GD` | int64     | Buts pour, contre, diff√©rence |
| `Pts`, `Pts/G`   | int64 / float64 | Points et moyenne par match |
| `xG`, `xGA`, `xGD`, `xGD/90` | float64 | Donn√©es d‚Äôexpected goals |
| `Attendance`     | int64     | Affluence moyenne |
| `Top Team Scorer`| object    | Meilleur buteur |
| `Goalkeeper`     | object    | Gardien principal |

---

#### - üèüÔ∏è Team Stats 2022-2023 (`2022-2023 Football Team Stats.csv`)

M√™me structure et signification que pour 2021-2022, mais avec la saison suivante.

---

#### - üîÑ Transfers √ât√© 2022 (`2022_2023_football_summer_transfers.csv`)

11 variables ‚Äì chaque ligne correspond √† un transfert.

| Variable        | Type    | Description |
|----------------|---------|-------------|
| `name`         | object  | Nom du joueur transf√©r√© |
| `position`     | object  | Poste            |
| `age`          | object  | √Çge              |
| `market_value` | object  | Valeur estim√©e   |
| `country_from` | object  | Pays de d√©part   |
| `league_from`  | object  | Ligue de d√©part  |
| `club_from`    | object  | Club de d√©part   |
| `country_to`   | object  | Pays d‚Äôarriv√©e   |
| `league_to`    | object  | Ligue d‚Äôarriv√©e  |
| `club_to`      | object  | Club d‚Äôarriv√©e   |
| `fee`          | object  | Montant du transfert (peut contenir "Free", "Loan", etc.) |

---

## **Analyse et r√©ponses aux questions**


```{r chargement-librairies, message=FALSE}
# Chargement des packages n√©cessaires

library(tidyverse)
library(ggplot2)
```


```{r importation-donnees, message=FALSE, warning=FALSE}
# Importation des donn√©es

player_stats_2021_2022 <- read.csv("data/2021-2022 Football Player Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2021_2022 <- read.csv("data/2021-2022 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2022_2023 <- read.csv("data/2022-2023 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
transfers_2022 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "ISO-8859-1")
```

---

### **Question 1:** Quels clubs ont le plus recrut√© par poste (top 20) ?

#### üéØ Objectif:
Identifier les **20 clubs les plus actifs** lors du mercato d‚Äô√©t√© 2022 en termes de nombre de recrues, puis visualiser quels postes ont √©t√© cibl√©s en priorit√© par ces clubs. Cela permet de mieux comprendre les **strat√©gies de renforcement** des effectifs selon les lignes de jeu (d√©fense, milieu, attaque).



```{r}
# Code

# Nettoyage de base
transfers_clean <- transfers_2022 %>%
  filter(!is.na(club_to), !is.na(position), position != "")

# Regrouper et compter
recrutements_par_poste <- transfers_clean %>%
  group_by(club_to, position) %>%
  summarise(nb_recrues = n(), .groups = "drop")

# Garder uniquement les 20 clubs ayant recrut√© le plus globalement
top_clubs <- recrutements_par_poste %>%
  group_by(club_to) %>%
  summarise(total_recrues = sum(nb_recrues)) %>%
  top_n(20, total_recrues) %>%
  pull(club_to)

# Filtrer les donn√©es
recrutements_top <- recrutements_par_poste %>%
  filter(club_to %in% top_clubs)

# Visualisation 
ggplot(recrutements_top, aes(x = position, y = fct_reorder(club_to, nb_recrues), fill = nb_recrues)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Top 20 clubs ‚Äì nombre de recrues par poste (√©t√© 2022)",
    x = "Poste",
    y = "Club",
    fill = "Nombre de recrues"
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### üß† Interpr√©tation du graphique:

- üîµ **US Salernitana 1919** est le club qui a le plus recrut√© tous postes confondus, avec un **focus important sur les milieux offensifs** et **d√©fenseurs centraux**.

- üîµ **US Lecce**, **US Cremonese** et **Udinese Calcio** (clubs italiens) montrent aussi une strat√©gie de **renforcement d√©fensif**, particuli√®rement en **centre-back**.

- üîµ **Olympique de Marseille** et **Nottingham Forest** ont **diversifi√© leurs recrutements** sur plusieurs lignes, y compris **les ailes** (*left/right winger*).

- üéØ On observe une **forte demande en milieux de terrain**, notamment :
  - *Attacking Midfield*
  - *Defensive Midfield*
  - *Centre Midfield*

-  Peu de clubs ont recrut√© plusieurs **gardiens**, ce qui est logique : un club n‚Äôen fait souvent venir qu‚Äôun seul par saison.

-  Certains clubs comme **FC Empoli** ou **OGC Nice** pr√©sentent une strat√©gie de recrutement **√©quilibr√©e sur diff√©rentes lignes**, ce qui pourrait indiquer un **renouvellement global de l‚Äôeffectif**.


---

### **Question 2:** Quels postes sont les plus valoris√©s sur le march√© ?


#### üéØ Objectif:
Visualiser la valeur marchande des joueurs par poste pour comprendre quels types de profils sont les plus pris√©s financi√®rement sur le march√©. Cela permet de hi√©rarchiser les postes selon leur importance √©conomique dans le football professionnel. Pour √ßa, on se base sur le mercato qui a eu lieu durant l'√©t√© 2022.


```{r}

# Nettoyage des donn√©es
transfers_clean <- transfers_2022 %>%
  filter(!is.na(position), !is.na(market_value)) %>%
  distinct(name, position, age, .keep_all = TRUE) %>%
  mutate(
    market_value_num = as.numeric(market_value)  # Convertir les valeurs en num√©rique
  ) %>%
  filter(market_value_num >= 1.5)  # Filtrer les valeurs n√©gatives/nulles ou pas r√©alistes genre en dessous de 1.5 millions

# On cr√©e une colonne pour regrouper certains postes qui sont tr√®s proches
transfers_clean <- transfers_clean %>%
  mutate(position_fr = position) %>%
  mutate(position_fr = recode(position_fr,
                              "Second Striker" = "Attaquant",
                              "Centre-Forward" = "Attaquant",
                              "Forward Attacker" = "Attaquant",
                              "attack" = "Attaquant",
                              "Right Midfield" = "Ailier droit",
                              "Left Midfield" = "Ailier gauche",
                              "Attacking Midfield" = "Milieu offensif",
                              "Central Midfield" = "Milieu central",
                              "Defensive Midfield" = "Milieu central", 
                              "Centre-Back" = "D√©fenseur central",
                              "defence" = "D√©fenseur central",
                              "Right Winger" = "Ailier droit",
                              "Left Winger" = "Ailier gauche", 
                              "Left-Back" = "D√©fenseur gauche",
                              "Right-Back" = "D√©fenseur droit",
                              "Goalkeeper" = "Gardien de but",
                              .default = position_fr))  # Par d√©faut, on garde la position d'origine

# Calcul de la moyenne et de l'√©cart-type des valeurs marchandes par poste
transfers_clean_stats <- transfers_clean %>%
  group_by(position_fr) %>%
  filter(n() >= 5) %>%  
  summarise(
    mean_value = mean(market_value_num, na.rm = TRUE),
    sd_value = sd(market_value_num, na.rm = TRUE)
  )

# Visualisation avec un barplot et des barres d'erreur pour voir les postes qui ont une grosse diff√©rence de prix
ggplot(transfers_clean_stats, aes(x = reorder(position_fr, mean_value), y = mean_value)) +
  geom_bar(stat = "identity", fill = "#4CAF50") +  
  geom_errorbar(aes(ymin = pmax(mean_value - sd_value, 0), ymax = mean_value + sd_value), width = 0.2) +
  labs(
    title = "Valeur marchande moyenne par poste (mercato √©t√© 2022)",
    x = "Poste",
    y = "Valeur marchande moyenne (Millions d'‚Ç¨)"
  ) +
  theme_minimal(base_size = 12) +
  coord_flip()



transfers_clean %>%
  count(position_fr, sort = TRUE)
print(transfers_clean %>% count(position_fr, sort = TRUE))



```


#### üß† Interpr√©tation du graphique:
Attaquant et Buteur : Les attaquants sont les joueurs les plus valoris√©s sur le march√©, avec une valeur moyenne qui d√©passe largement celle des autres postes. Cela refl√®te l'importance des joueurs offensifs dans le football moderne, o√π les buts et les performances offensives sont souvent d√©cisives mais surtout les attaquants sont souvent les joueurs qui attirent le plus l'attention des fans et des m√©dias, ce qui en fait des atouts marketing pr√©cieux pour les clubs et qui explique leur valeur bien plus √©lev√©

D√©fenseur central : Les d√©fenseurs centraux occupent la deuxi√®me place en termes de valeur marchande. Leur r√¥le crucial dans la stabilit√© d√©fensive et leur capacit√© √† organiser la d√©fense expliquent cette valorisation √©lev√©e. Un bon d√©fenseur central peut √™tre la cl√© de vo√ªte d'une √©quipe solide et √©quilibr√©e.

Ailier droit et Ailier gauche : Les ailiers, qu‚Äôils soient droits ou gauches, pr√©sentent une valeur marchande significative sur le march√© des transferts avec respectivement la 3√®me et 5√®me place. Toutefois, on observe souvent une l√©g√®re survalorisation des ailiers droits. Cette diff√©rence peut s‚Äôexpliquer par la raret√© relative des ailiers droits car cela implique souvent d'√™tre gaucher, pour √™tre capables de repiquer dans l‚Äôaxe et de frapper avec leur pied fort. Ce profil est tr√®s recherch√© dans le football moderne d‚Äôo√π une valorisation plus √©lev√©e.

Milieu central et offensif : Les milieux centraux, souvent consid√©r√©s comme les "poumons" de l'√©quipe, sont √©galement tr√®s valoris√©s. Leur polyvalence et leur capacit√© √† influencer le jeu dans les deux sens en font des acteurs cl√©s sur le march√©. Paradoxalement, les milieux offensifs semblent √™tre moins bien valoris√©s. C'est un poste qui, dans le football moderne, a perdu de sa splendeur par rapport √† avant et c'est caract√©ris√© par une baisse de la valeur marchande √† ce poste.

D√©fenseur gauche et D√©fenseur droit : Les d√©fenseurs lat√©raux, bien que moins valoris√©s que les d√©fenseurs centraux, restent importants.Ils sont tr√®s recherch√©s dans le football moderne car ils doivent √™tre polyvalents, capables de d√©fendre et d'attaquer efficacement.On ne retrouve pas la raret√© des lat√©raux droit par rapport au gauche comme on peut avoir avec les ailiers et on remarque qu'√† l'inverse les lat√©raux gauche on tendance √† avoir une plus grosse valeur marchande. 

Gardien de but : Les gardiens de but sont nettement moins valoris√©s que les autres postes. Cela s‚Äôexplique en partie par la sp√©cificit√© de ce r√¥le, qui diff√®re fortement des autres positions sur le terrain. Par extension, c‚Äôest aussi le poste le moins "vendeur" du football, ce qui se refl√®te dans leur valeur marchande.



---

### **Question 3:** 

Corr√©lation entre xG et points ?

#### üéØ Objectif:

Analyser si le nombre d‚Äôexpected goals (xG) r√©alis√©s par une √©quipe est corr√©l√© avec son total de points en championnat. Cela permet de v√©rifier si produire beaucoup d‚Äôoccasions (m√™me sans forc√©ment marquer) est un bon indicateur de performance globale.


```{r}
# On utilise les donn√©es de la saison 2022-2023
team_stats_22_23 <- team_stats_2022_2023 %>%
  select(Squad, xG, Pts)

# Nettoyage basique : on supprime les NA au cas o√π
team_stats_22_23 <- team_stats_22_23 %>%
  filter(!is.na(xG), !is.na(Pts))

# Visualisation scatter plot
ggplot(team_stats_22_23, aes(x = xG, y = Pts)) +
  geom_point(color = "#1f77b4", size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
  labs(
    title = "Corr√©lation entre Expected Goals (xG) et Points en championnat (2022-23)",
    x = "Expected Goals (xG)",
    y = "Points",
    caption = "Source : 2022-2023 Football Team Stats.csv"
  ) +
  theme_minimal(base_size = 12)

# Calcul du coefficient de corr√©lation de Pearson
cor_xg_pts <- cor(team_stats_22_23$xG, team_stats_22_23$Pts, use = "complete.obs")
paste0("Coefficient de corr√©lation de Pearson : ", round(cor_xg_pts, 3))

```


#### üß† Interpr√©tation du graphique:
Le graphique montre qu‚Äôil existe une forte corr√©lation positive entre les expected goals (xG) et les points obtenus en championnat lors de la saison 2022-2023. Le coefficient de corr√©lation de Pearson est de 0,815, ce qui indique qu‚Äôen g√©n√©ral, plus une √©quipe g√©n√®re d‚Äôoccasions de but de qualit√© (mesur√©es par les xG), plus elle obtient de points au classement. Cela confirme que produire beaucoup d‚Äôoccasions est un √©l√©ment important pour r√©ussir sur toute une saison.

Cependant, la relation n‚Äôest pas parfaite. On observe que certains points sont assez √©loign√©s de la tendance g√©n√©rale. Cela peut s‚Äôexpliquer par plusieurs facteurs, comme l‚Äôefficacit√© offensive, c‚Äôest-√†-dire la capacit√© √† transformer les occasions en buts, ou encore la solidit√© d√©fensive. Une √©quipe peut cr√©er beaucoup d‚Äôoccasions mais manquer de r√©alisme ou encaisser trop de buts, ce qui limite son total de points.

En r√©sum√©, les expected goals sont un bon indicateur des performances d‚Äôune √©quipe, mais ils ne suffisent pas √† eux seuls pour expliquer compl√®tement les r√©sultats. D‚Äôautres aspects du jeu, comme la finition ou la d√©fense, restent essentiels.

---

### **Question 4:** 


#### üéØ Objectif:



```{r}
# Code
```


#### üß† Interpr√©tation du graphique:




