---
title: "Rapport IF36"
author: "Ahamad MOHAMMAD, Minko Bikono NEIL-JOVY, Simon GELBART, Willen AMICHE"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: cayman       
    highlight: github   
    toc: true
    toc_depth: 3
encoding: UTF-8
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,     
  warning = FALSE,  
  message = FALSE   
)
```



## **Introduction**
L‚Äôobjectif de ce projet est d‚Äôexplorer l‚Äôimpact des strat√©gies de recrutement sur les performances sportives des clubs de football et de leurs joueurs. En croisant des statistiques individuelles (performances des joueurs), des donn√©es collectives (r√©sultats d‚Äô√©quipes) et les transferts r√©alis√©s lors du mercato estival 2022, nous cherchons √† identifier les leviers de performance et √† mieux comprendre les choix strat√©giques op√©r√©s par les clubs.
Notre analyse se base sur deux saisons compl√®tes (2021-2022 et 2022-2023), afin de mesurer l‚Äô√©volution des r√©sultats d‚Äôune ann√©e sur l‚Äôautre et de relier cette √©volution aux dynamiques de recrutement. √Ä travers plusieurs angles d‚Äôanalyse (volume de transferts, postes cibl√©s, valeur marchande, origine des joueurs, rendement, etc.), nous chercherons √† r√©pondre √† une s√©rie de questions permettant de quantifier et qualifier l'effet des recrutements sur la r√©ussite des √©quipes.

 


### **üìä Description des variables**

#### - üßç‚Äç‚ôÇÔ∏è Player Stats 2021-2022 (`2021-2022 Football Player Stats.csv`)

143 variables ‚Äì chaque ligne correspond √† un joueur pour la saison 2021-2022.

| Variable          | Type      | Description approximative |
|-------------------|-----------|----------------------------|
| `Rk`              | int64     | Rang ou ID du joueur       |
| `Player`          | object    | Nom du joueur              |
| `Nation`          | object    | Nationalit√©                |
| `Pos`             | object    | Poste                      |
| `Squad`           | object    | Club                       |
| `Comp`            | object    | Comp√©tition principale     |
| `Age`             | object    | √Çge                        |
| `Born`            | object    | Ann√©e de naissance         |
| ...               | ...       | ...et plus de 130 autres statistiques de jeu : buts, passes, tirs, dribbles, fautes, tacles, interceptions, passes progressives, etc. |
| `AerWon`          | float64   | Duels a√©riens gagn√©s       |
| `AerLost`         | float64   | Duels a√©riens perdus       |
| `AerWon%`         | float64   | Pourcentage de duels a√©riens gagn√©s |

---

#### - üèüÔ∏è Team Stats 2021-2022 (`2021-2022 Football Team Stats.csv`)

20 variables ‚Äì chaque ligne correspond √† une √©quipe.

| Variable          | Type      | Description |
|------------------|-----------|-------------|
| `Rk`             | int64     | Rang        |
| `Squad`          | object    | Nom du club |
| `Country`        | object    | Pays        |
| `LgRk`           | int64     | Classement dans la ligue |
| `MP`, `W`, `D`, `L` | int64  | Matchs jou√©s, Victoires, Nuls, D√©faites |
| `GF`, `GA`, `GD` | int64     | Buts pour, contre, diff√©rence |
| `Pts`, `Pts/G`   | int64 / float64 | Points et moyenne par match |
| `xG`, `xGA`, `xGD`, `xGD/90` | float64 | Donn√©es d‚Äôexpected goals |
| `Attendance`     | int64     | Affluence moyenne |
| `Top Team Scorer`| object    | Meilleur buteur |
| `Goalkeeper`     | object    | Gardien principal |

---

#### - üèüÔ∏è Team Stats 2022-2023 (`2022-2023 Football Team Stats.csv`)

M√™me structure et signification que pour 2021-2022, mais avec la saison suivante.

---

#### - üîÑ Transfers √ât√© 2022 (`2022_2023_football_summer_transfers.csv`)

11 variables ‚Äì chaque ligne correspond √† un transfert.

| Variable        | Type    | Description |
|----------------|---------|-------------|
| `name`         | object  | Nom du joueur transf√©r√© |
| `position`     | object  | Poste            |
| `age`          | object  | √Çge              |
| `market_value` | object  | Valeur estim√©e   |
| `country_from` | object  | Pays de d√©part   |
| `league_from`  | object  | Ligue de d√©part  |
| `club_from`    | object  | Club de d√©part   |
| `country_to`   | object  | Pays d‚Äôarriv√©e   |
| `league_to`    | object  | Ligue d‚Äôarriv√©e  |
| `club_to`      | object  | Club d‚Äôarriv√©e   |
| `fee`          | object  | Montant du transfert (peut contenir "Free", "Loan", etc.) |

---

## **Analyse et r√©ponses aux questions**


```{r chargement-librairies, message=FALSE}
# Chargement des packages n√©cessaires

library(tidyverse)
library(ggplot2)
library(scales)
library(dplyr)
library(stringr)
library(ggalluvial)
library(fmsb)
library(shiny)
library(shinydashboard)
library(DT)
library(fontawesome)
```


```{r importation-donnees, message=FALSE, warning=FALSE}
# Importation des donn√©es

player_stats_2021_2022 <- read.csv("data/2021-2022 Football Player Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2021_2022 <- read.csv("data/2021-2022 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
team_stats_2022_2023 <- read.csv("data/2022-2023 Football Team Stats.csv", sep = ";", fileEncoding = "ISO-8859-1")
transfers_2022 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "ISO-8859-1")
```


```{r}
# Traduction des postes 
transfers_2022 <- transfers_2022 %>%
  mutate(position = str_trim(position)) %>%
  mutate(position = recode(position,
    "Centre-Forward" = "Attaquant",
    "Second Striker" = "Attaquant",
    "Forward Attacker" = "Attaquant",
    "attack" = "Attaquant",

    "Right Winger" = "Ailier droit",
    "Right Midfield" = "Ailier droit",

    "Left Winger" = "Ailier gauche",
    "Left Midfield" = "Ailier gauche",

    "Attacking Midfield" = "Milieu offensif",
    "Defensive Midfield" = "Milieu d√©fensif",
    "Central Midfield" = "Milieu central",

    "Centre-Back" = "D√©fenseur central",
    "defence" = "D√©fenseur central",
    "Left-Back" = "D√©fenseur gauche",
    "Right-Back" = "D√©fenseur droit",

    "Goalkeeper" = "Gardien de but",

    .default = "Autre"
  ))

```

---

### **Question 1 : Quels clubs ont le plus recrut√© par poste (top 20) ?**

#### üéØ Objectif:
Identifier les **20 clubs les plus actifs** lors du mercato d‚Äô√©t√© 2022 en termes de nombre de recrues, puis visualiser quels postes ont √©t√© cibl√©s en priorit√© par ces clubs. Cela permet de mieux comprendre les **strat√©gies de renforcement** des effectifs selon les lignes de jeu (d√©fense, milieu, attaque).

#### üß™ Hypoth√®se :
Nous supposons que les clubs ayant termin√© en bas de classement ou nouvellement promus ont davantage recrut√©, notamment en d√©fense et au milieu, dans une logique de **renforcement pour assurer le maintien**. √Ä l‚Äôinverse, les clubs plus stables ou ambitieux auraient fait un recrutement plus cibl√© et r√©parti entre les lignes.



```{r message=FALSE}
# Code
#pr bien lire les accent on met en UTF
transfers_2022_q1 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "UTF-8")

# Nettoyage de base
transfers_clean <- transfers_2022_q1 %>%
  filter(!is.na(club_to), !is.na(position), position != "")

# Regrouper et compter
recrutements_par_poste <- transfers_clean %>%
  group_by(club_to, position) %>%
  summarise(nb_recrues = n(), .groups = "drop")

# Garder uniquement les 20 clubs ayant recrut√© le plus globalement
top_clubs <- recrutements_par_poste %>%
  group_by(club_to) %>%
  summarise(total_recrues = sum(nb_recrues)) %>%
  top_n(20, total_recrues) %>%
  pull(club_to)

# Filtrer les donn√©es
recrutements_top <- recrutements_par_poste %>%
  filter(club_to %in% top_clubs)

# Visualisation 
ggplot(recrutements_top, aes(x = position, y = fct_reorder(club_to, nb_recrues), fill = nb_recrues)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Top 20 clubs ‚Äì nombre de recrues par poste (√©t√© 2022)",
    x = "Poste",
    y = "Club",
    fill = "Nombre de recrues"
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### üß† Interpr√©tation du graphique:

- üîµ **US Salernitana 1919**, un club ayant lutt√© pour le maintien en Serie A, est celui qui a le plus recrut√© tous postes confondus, avec un **focus important sur les milieux offensifs** et **d√©fenseurs centraux**. Cela **confirme notre hypoth√®se**.

- üîµ D‚Äôautres clubs comme **US Lecce**, **US Cremonese** et **Udinese Calcio**, √©galement engag√©s dans la lutte pour le maintien, pr√©sentent aussi une strat√©gie de **renforcement d√©fensif**, particuli√®rement au poste de **centre-back**.

- üîµ En revanche, certains clubs comme **Olympique de Marseille** ou **Nottingham Forest**, pourtant positionn√©s plus haut (ou avec de grandes ambitions), ont **diversifi√© leurs recrutements** sur plusieurs lignes, ce qui nuance l‚Äôhypoth√®se. Cela peut refl√©ter une strat√©gie de **reconstruction d‚Äôeffectif** ou de pr√©paration √† des comp√©titions europ√©ennes.

- üîµ On observe une **forte demande en milieux de terrain**, avec une concentration sur les postes de *milieu central*, *d√©fensif* et *offensif*, ce qui correspond bien √† l‚Äôid√©e que la ma√Ætrise du milieu de terrain reste cruciale dans le football moderne.

- Peu de clubs ont recrut√© plusieurs **gardiens**, ce qui est conforme aux pratiques usuelles : un club ne recrute g√©n√©ralement qu‚Äôun seul gardien par saison.

- Enfin, certains clubs comme **FC Empoli** ou **OGC Nice** ont adopt√© une strat√©gie plus √©quilibr√©e, en recrutant sur plusieurs lignes, ce qui peut traduire un **renouvellement global** plut√¥t qu‚Äôun ajustement sp√©cifique.

‚úÖ **Conclusion** : l‚Äôhypoth√®se est **globalement confirm√©e** ‚Äì les clubs les moins bien class√©s ont recrut√© plus, notamment en d√©fense. Toutefois, des exceptions existent, li√©es √† des objectifs plus strat√©giques ou sp√©cifiques (comme l‚ÄôEurope ou le changement d‚Äôentra√Æneur).


---

### **Question 2: Quels postes sont les plus valoris√©s sur le march√© ?**


#### üéØ Objectif:
Visualiser la valeur marchande des joueurs par poste pour comprendre quels types de profils sont les plus pris√©s financi√®rement sur le march√©. Cela permet de hi√©rarchiser les postes selon leur importance √©conomique dans le football professionnel, sur la base du mercato d‚Äô√©t√© 2022.

#### üß™ Hypoth√®se :
Nous pensons que les **attaquants** seront les plus valoris√©s sur le march√©, en raison de leur impact direct sur les r√©sultats et leur potentiel marketing. Les **d√©fenseurs centraux** et **milieux offensifs** devraient aussi avoir une valeur √©lev√©e. √Ä l'inverse, les **gardiens** devraient √™tre en bas de l‚Äô√©chelle.


```{r message=FALSE}

# Nettoyage et pr√©paration des donn√©es de transfert
transfers_clean <- transfers_2022 %>%
  filter(!is.na(position), !is.na(market_value)) %>%
  distinct(name, position, age, .keep_all = TRUE) %>%
  mutate(
    market_value = gsub("[^0-9\\.]", "", market_value), 
    market_value_num = as.numeric(market_value)
  ) %>%
  filter(market_value_num >= 1.5)

# Calcul de la moyenne et de l'√©cart-type des valeurs marchandes par poste
transfers_clean_stats <- transfers_clean %>%
  group_by(position) %>%
  filter(n() >= 5) %>%
  summarise(
    mean_value = mean(market_value_num, na.rm = TRUE),
    sd_value = sd(market_value_num, na.rm = TRUE)
  )

# Visualisation avec titres en fran√ßais
ggplot(transfers_clean_stats, aes(x = reorder(position, mean_value), y = mean_value)) +
  geom_bar(stat = "identity", fill = "#4CAF50") +  
  geom_errorbar(aes(ymin = pmax(mean_value - sd_value, 0), ymax = mean_value + sd_value), width = 0.2) +
  labs(
    title = "Valeur marchande moyenne par poste (mercato √©t√© 2022)",
    x = "Poste (en anglais)",
    y = "Valeur marchande moyenne (en millions d'euros)"
  ) +
  theme_minimal(base_size = 12) +
  coord_flip()


```


#### üß† Interpr√©tation du graphique :

Ce graphique combine deux informations importantes :

- les barres vertes indiquent la valeur marchande moyenne des joueurs par poste ;

- les barres noires (barres d‚Äôerreur) repr√©sentent l‚Äô√©cart-type, c‚Äôest-√†-dire la variabilit√© des valeurs selon les profils.

- üîµ Les attaquants sont effectivement les plus valoris√©s, avec une moyenne nettement sup√©rieure. Cela confirme leur r√¥le strat√©gique et commercial. Leur forte variabilit√© montre que certains sont recrut√©s √† prix tr√®s √©lev√©, tirant la moyenne vers le haut.

- üîµ Les d√©fenseurs centraux arrivent en seconde position, avec une valeur moyenne √©lev√©e et une dispersion plus contenue, signe d‚Äôune reconnaissance stable de leur importance.

- üîµ Les ailiers droits et gauches pr√©sentent aussi des valeurs √©lev√©es, ce qui refl√®te la raret√© de certains profils tr√®s recherch√©s (notamment les ailiers gauchers jouant √† droite).

- üîµ Les milieux offensifs sont un peu moins valoris√©s que pr√©vu, et affichent une grande h√©t√©rog√©n√©it√© : cela sugg√®re une disparit√© importante entre quelques stars tr√®s co√ªteuses et d‚Äôautres profils plus modestes.

- üîµ Les gardiens sont les moins valoris√©s, avec une moyenne basse et une variabilit√© plus r√©duite, ce qui traduit leur statut secondaire sur le march√©.

‚úÖ Conclusion : L‚Äôhypoth√®se est largement confirm√©e. Les attaquants et d√©fenseurs centraux dominent en valeur. L‚Äôajout des barres d‚Äôerreur r√©v√®le aussi des disparit√©s fortes sur certains postes, notamment offensifs, ce qui enrichit l‚Äôanalyse au-del√† des moyennes seules.


---


### **Question 3 : Corr√©lation entre xG (expected goals) et points ?**

#### üéØ Objectif:
Analyser si le nombre d‚Äôexpected goals (xG) r√©alis√©s par une √©quipe est corr√©l√© avec son total de points en championnat. Cela permet de v√©rifier si produire beaucoup d‚Äôoccasions de qualit√© est un bon indicateur de performance globale. Les expected goals (xG) mesurent la probabilit√© qu‚Äôun tir se transforme en but, en fonction de facteurs comme la position du tir, le type d‚Äôaction, l‚Äôangle de tir ou la pression d√©fensive. En somme, plus une √©quipe cumule d‚ÄôxG, plus elle est cens√©e marquer. Donn√©es utilis√©es : saison 2022-2023.

#### üß™ Hypoth√®se :
Nous pensons qu‚Äôil existe une **corr√©lation positive significative** entre les xG et le total de points. Une √©quipe qui se cr√©e beaucoup d‚Äôoccasions de qualit√© a plus de chances de gagner des matchs, m√™me si la finition varie.


```{r message=FALSE}
team_stats_22_23 <- team_stats_2022_2023 %>%
  select(Squad, xG, Pts) %>%
  filter(!is.na(xG), !is.na(Pts))

ggplot(team_stats_22_23, aes(x = xG, y = Pts)) +
  geom_point(color = "#1f77b4", size = 3) +
  geom_smooth(method = "lm", color = "red", linetype = "dashed", se = TRUE) +  # se = TRUE pour afficher l'intervalle
  labs(
    title = "Corr√©lation entre Expected Goals (xG) et Points en championnat(2022-23)",
    x = "Expected Goals (xG)",
    y = "Points"
  ) +
  theme_minimal(base_size = 12)


```


#### üß† Interpr√©tation du graphique:

- üîµ Le nuage de points pr√©sente une **tendance lin√©aire positive** entre les xG et les points, confirm√©e par la droite de r√©gression.

- üîµ Cela sugg√®re que les √©quipes qui se cr√©ent beaucoup d‚Äôoccasions obtiennent en g√©n√©ral plus de points, ce qui **valide notre hypoth√®se**.

- üîµ Certaines √©quipes d√©vient de la tendance (sous-performance ou efficacit√© maximale), ce qui montre que les xG ne suffisent pas √† eux seuls √† expliquer les r√©sultats.

‚úÖ **Conclusion** : L‚Äôhypoth√®se est **confirm√©e**. Il existe une forte corr√©lation entre production offensive (xG) et performance en championnat.

---

### **Question 4 : Quel est l'impact des transferts sur la performance des clubs entre 2021-2022 et 2022-2023 ?**

#### üéØ Objectif:
Analyser l'√©volution de la performance des clubs entre deux saisons (2021-2022 ‚ûî 2022-2023) en fonction de leur nombre de recrues durant l'√©t√© 2022. L‚Äôobjectif est de voir s‚Äôil existe une corr√©lation entre le volume de recrutement et l‚Äô√©volution du classement.

#### üß™ Hypoth√®se :
Nous pensons que les clubs ayant recrut√© **mod√©r√©ment (4 √† 6 joueurs)** progresseront davantage, car ils auront cibl√© leurs besoins. Ceux qui ont **recrut√© massivement** risquent d‚Äôavoir des r√©sultats plus h√©t√©rog√®nes √† cause du manque de coh√©sion. Les clubs **n‚Äôayant pas recrut√©** pourraient stagner ou r√©gresser.



```{r message=FALSE}

# Regrouper les clubs qui ont recrut√© et compter
nb_recrues_club <- transfers_clean %>%
  group_by(club_to) %>%
  summarise(nb_recrues = n(), .groups = "drop")

# Pr√©parer les classements par saison
classements_2021_2022 <- team_stats_2021_2022 %>%
  select(Squad, LgRk) %>%
  rename(club = Squad, classement_2022 = LgRk)

classements_2022_2023 <- team_stats_2022_2023 %>%
  select(Squad, LgRk) %>%
  rename(club = Squad, classement_2023 = LgRk)

# Fusionner tout ensemble
evolution_clubs <- classements_2021_2022 %>%
  inner_join(classements_2022_2023, by = "club") %>%
  left_join(nb_recrues_club, by = c("club" = "club_to")) %>%
  mutate(
    nb_recrues = replace_na(nb_recrues, 0),  # certains clubs peuvent avoir 0 recrutement
    evolution_classement = classement_2022 - classement_2023
  ) %>%
  mutate(
    categorie_recrutement = case_when(
      nb_recrues == 0 ~ "0 recrue",
      nb_recrues <= 3 ~ "1-3 recrues",
      nb_recrues <= 6 ~ "4-6 recrues",
      TRUE ~ "7+ recrues"
    )
  )

# Visualisation : boxplot avec palette corrig√©e
ggplot(evolution_clubs, aes(x = categorie_recrutement, y = evolution_classement, fill = categorie_recrutement)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_manual(
    values = c(
      "0 recrue" = "#f8766d",        
      "1-3 recrues" = "#f1c40f",     
      "4-6 recrues" = "#2ecc71",    
      "7+ recrues" = "#3498db"      
    )
  ) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  labs(
    title = "Impact du recrutement sur l'√©volution du classement (2021-2023)",
    subtitle = "Distribution de l'√©volution de position en fonction du nombre de recrues estivales",
    x = "Nombre de recrues (cat√©gories)",
    y = "√âvolution du classement (positif = am√©lioration)",
    fill = "Recrutements"
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "right")


```


#### üß† Interpr√©tation du graphique:

- üîµ Les clubs n‚Äôayant recrut√© aucun joueur pr√©sentent des r√©sultats tr√®s variables, avec une m√©diane proche de z√©ro. Cela sugg√®re qu‚Äôen l‚Äôabsence de renfort, il est difficile de progresser de mani√®re structur√©e, et que la stabilit√© seule ne suffit pas toujours.

- üîµ Les clubs ayant recrut√© entre 1 et 3 joueurs semblent en l√©g√®re r√©gression. Ce type de recrutement limit√© peut refl√©ter un ajustement insuffisant face aux besoins de l‚Äôeffectif.

- üîµ En revanche, les clubs ayant recrut√© entre 4 et 6 joueurs enregistrent en moyenne une am√©lioration de leur classement. Cela semble indiquer qu‚Äôun renforcement cibl√©, sans bouleverser l‚Äô√©quilibre collectif, est plus efficace.

- üîµ √Ä l‚Äôoppos√©, les clubs ayant recrut√© 7 joueurs ou plus affichent une m√©diane n√©gative et une forte dispersion des r√©sultats. Cela peut s‚Äôexpliquer par une perte de rep√®res au sein du groupe : remplacer trop de joueurs √† la fois nuit √† la coh√©sion et impose de reconstruire l‚Äôesprit d‚Äô√©quipe, ce qui peut ralentir les performances sportives.

‚úÖ **Conclusion** : L‚Äôhypoth√®se est **largement confirm√©e** : un recrutement cibl√© et mesur√© semble plus b√©n√©fique qu‚Äôun mercato massif ou une inaction.

---


### **Question 5 : Quels sont les transferts les plus co√ªteux de l‚Äô√©t√© 2022 ? **

#### üéØ Objectif: 
Identifier les joueurs ayant fait l‚Äôobjet des transferts les plus on√©reux durant le mercato estival 2022, afin de mieux comprendre o√π se concentrent les plus gros investissements du march√©.


#### üß™ Hypoth√®se :
Les attaquants et les jeunes espoirs prometteurs devraient constituer la majorit√© des transferts les plus chers, notamment en direction des grands clubs europ√©ens.



```{r}

transfers_2022_q5 <- read.csv("data/2022_2023_football_summer_transfers.csv", sep = ",", fileEncoding = "UTF-8")

# Nettoyage des montants
transferts_top <- transfers_2022_q5 %>%
  filter(!is.na(fee)) %>%
  mutate(fee_num = str_extract(fee, "[0-9,.]+"),
         fee_num = as.numeric(gsub(",", ".", fee_num))) %>%
  filter(!is.na(fee_num)) %>%
  arrange(desc(fee_num)) %>%
  distinct(name, .keep_all = TRUE) %>%
  slice_max(fee_num, n = 15)


# Graphique
ggplot(transferts_top, aes(x = reorder(name, fee_num), y = fee_num)) +
  geom_col(fill = "#1f77b4") +
  coord_flip() +
  labs(
    title = "Top 15 des transferts les plus chers ‚Äì √ât√© 2022",
    x = "Joueur",
    y = "Montant du transfert (en millions ‚Ç¨)"
  ) +
  theme_minimal(base_size = 12)

```


#### üß† Interpr√©tation du graphique:

- üîµ Le graphique met en √©vidence les 15 plus grosses transactions du mercato d‚Äô√©t√© 2022.

- üîµ Une forte majorit√© des joueurs sont des profils offensifs : attaquants ou milieux cr√©atifs.

- üîµ On retrouve principalement des clubs disposant d‚Äôun fort pouvoir d‚Äôachat, issus de la Premier League ou des grands championnats europ√©ens.

- üîµ Les sommes engag√©es confirment l‚Äôimportance strat√©gique de certains postes et le pari sur le potentiel futur des jeunes joueurs.


‚úÖ **Conclusion** :  L‚Äôhypoth√®se est confirm√©e. Les plus grosses d√©penses concernent surtout des joueurs offensifs ou tr√®s jeunes, recrut√©s par des clubs ambitieux financi√®rement. Cela illustre la concentration des investissements sur des profils √† fort impact ou √† forte valeur de revente.

---

### **Question 6 : Quelle part des buts est marqu√©e par des recrues (top 10) **

#### üéØ Objectif:
Mesurer la contribution directe des joueurs recrut√©s √† l‚Äô√©t√© 2022 dans le total des buts marqu√©s par leur club en 2022-2023.

#### üß™ Hypoth√®se :
Les recrues, devraient repr√©senter une part importante des buts dans les clubs ayant beaucoup investi.



```{r}
# Nettoyage des donn√©es de transfert
transfers_cleaned <- transfers_2022 %>%
  filter(!is.na(club_to), !is.na(name)) %>%
  distinct(name, club_to)

# Nettoyage et regroupement des joueurs recrut√©s
recrues_stats <- player_stats_2021_2022 %>%
  rename(name = Player, club = Squad, buts = Goals, minutes = Min) %>%
  mutate(name = str_trim(name)) %>%
  inner_join(transfers_cleaned, by = "name") %>%
  filter(!is.na(buts)) %>%
  group_by(club_to) %>%
  summarise(buts_recrues = sum(as.numeric(buts), na.rm = TRUE), .groups = "drop")

# Buts totaux par club (2022-2023)
buts_totaux <- team_stats_2022_2023 %>%
  rename(club = Squad) %>%
  select(club, GF)

# Fusion des datasets
part_buts <- buts_totaux %>%
  left_join(recrues_stats, by = c("club" = "club_to")) %>%
  mutate(
    buts_recrues = replace_na(buts_recrues, 0),
    part_recrues = buts_recrues / GF
  ) %>%
  filter(GF > 0, part_recrues > 0) %>% # on garde uniquement les clubs actifs
  arrange(desc(part_recrues)) %>%
  slice_max(part_recrues, n = 10)

# Visualisation en barres horizontales
ggplot(part_buts, aes(x = reorder(club, part_recrues), y = part_recrues)) +
  geom_col(fill = "#0072B2") +
  coord_flip() +
  scale_y_continuous(labels = percent_format(accuracy = 1)) +
  labs(
    title = "Part des buts marqu√©s par des recrues (Top 10 clubs)",
    x = "Club",
    y = "Part des buts (%)"
  ) +
  theme_minimal(base_size = 12)
```


#### üß† Interpr√©tation du graphique:

- üîµ Le graphique met en valeur les 10 clubs o√π les recrues ont contribu√© de mani√®re significative au total des buts.

- üîµ Cela confirme l‚Äôimpact potentiel des nouveaux joueurs sur le rendement offensif d‚Äôune √©quipe, surtout en cas de bonne int√©gration.

‚úÖ **Conclusion** :  L‚Äôhypoth√®se est partiellement confirm√©e. Dans certains clubs, les recrues ont √©t√© d√©terminantes offensivement. Dans d‚Äôautres, leur impact a √©t√© plus indirect. La contribution d√©pend donc fortement du profil des joueurs recrut√©s et du besoin tactique identifi√©.



---

### **Question 7 : Quel est le rendement des recrues vs anciens **

#### üéØ Objectif:
Comparer l‚Äôefficacit√© offensive des recrues vs les joueurs d√©j√† pr√©sents.



#### üß™ Hypoth√®se :
Les joueurs d√©j√† int√©gr√©s au collectif devraient avoir un meilleur rendement offensif, car les recrues ont souvent besoin de temps pour s‚Äôadapter.


```{r}
# Liste des recrues (nom + club)
recrues <- transfers_2022 %>%
  filter(!is.na(name)) %>%
  distinct(name) %>%
  mutate(statut = "Recrue")

# Donn√©es joueurs avec efficacit√© offensive
rendement_joueurs <- player_stats_2021_2022 %>%
  rename(name = Player, buts = Goals, minutes = Min) %>%
  mutate(name = str_trim(name),
         buts = as.numeric(buts),
         minutes = as.numeric(minutes),
         rendement = buts / minutes) %>%
  filter(!is.na(rendement), minutes > 200) %>%
  mutate(statut = ifelse(name %in% recrues$name, "Recrue", "D√©j√† pr√©sent"))

# Visualisation : violin plot du rendement
ggplot(rendement_joueurs, aes(x = statut, y = rendement, fill = statut)) +
  geom_violin(trim = FALSE, alpha = 0.7) +
  geom_boxplot(width = 0.1, color = "black", outlier.shape = NA) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  labs(
    title = "Rendement offensif : Recrues vs Joueurs d√©j√† pr√©sents",
    x = "",
    y = "Buts par minute jou√©e"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none")
```


#### üß† Interpr√©tation du graphique:

- üîµ La forme du violin plot montre la distribution compl√®te du rendement offensif.

- üîµ Les joueurs d√©j√† pr√©sents pr√©sentent une distribution plus homog√®ne et une m√©diane plus √©lev√©e.

- üîµ Les recrues ont un rendement plus variable : certains tr√®s efficaces, mais aussi de nombreux cas en dessous de la m√©diane des anciens.

‚úÖ **Conclusion** :  L‚Äôhypoth√®se est globalement confirm√©e. Les joueurs d√©j√† pr√©sents affichent un meilleur rendement moyen que les recrues, ce qui refl√®te sans doute une meilleure adaptation au syst√®me de jeu. Cependant, certaines recrues affichent des performances remarquables, ce qui montre leur potentiel une fois int√©gr√©es.

---

### **Question 8 : Recrutement local vs international? (top 15)**

#### üéØ Objectif:
Visualiser la r√©partition g√©ographique du top 15 des recrutements pour √©valuer dans quelle mesure les clubs recrutent localement ou √† l‚Äôinternational.

#### üß™ Hypoth√®se :
Les grands clubs europ√©ens recrutent principalement √† l‚Äôinternational, tandis que les clubs de second rang privil√©gient les transferts nationaux pour des raisons de co√ªt et de logistique.


```{r}
# Identifier les 15 pays qui ont recrut√© le plus
top_pays <- transfers_2022 %>%
  filter(!is.na(country_to)) %>%
  count(country_to, name = "nb_total") %>%
  top_n(15, nb_total) %>%
  pull(country_to)

# Pr√©parer les donn√©es filtr√©es
transfers_local_vs_intl <- transfers_2022 %>%
  filter(!is.na(country_from), !is.na(country_to)) %>%
  mutate(type = ifelse(country_from == country_to, "National", "International")) %>%
  count(country_to, type, name = "nb_transferts") %>%
  filter(country_to %in% top_pays)

# Barplot group√© 
ggplot(transfers_local_vs_intl, aes(x = reorder(country_to, -nb_transferts), y = nb_transferts, fill = type)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Recrutements nationaux vs internationaux (Top 15 pays ‚Äì √©t√© 2022)",
    x = "Pays de destination",
    y = "Nombre de transferts",
    fill = "Type de transfert"
  ) +
  theme_minimal(base_size = 13) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


#### üß† Interpr√©tation du graphique:

- üîµ Certains pays comme l‚ÄôAllemagne ou l‚ÄôEspagne ont un bon √©quilibre entre local et international.

- üîµ Les clubs des championnats secondaires recrutent davantage localement, contrairement aux clubs anglais ou italiens.


‚úÖ **Conclusion** :  L‚Äôhypoth√®se est confirm√©e. Le recrutement international est pr√©pond√©rant dans les grands championnats, mais des flux internes nationaux importants subsistent dans certains pays. La carte des transferts illustre une g√©opolitique du football bien ancr√©e.

---

### **Question 9 : Quels clubs misent sur des jeunes joueurs ?**

#### üéØ Objectif:

Identifier les clubs qui int√®grent le plus de jeunes joueurs dans leur effectif et leur donnent du temps de jeu.

#### üß™ Hypoth√®se :

Certains clubs, notamment ceux ayant une strat√©gie ax√©e sur la formation ou la revente de joueurs (comme RB Salzburg, l'Ajax ou Barcelone), misent davantage sur les jeunes talents, tant en nombre qu‚Äôen minutes jou√©es. On peut √©galement s‚Äôattendre √† observer une forte pr√©sence de jeunes joueurs dans les clubs des championnats fran√ßais et espagnol, ces pays disposant de viviers de talents particuli√®rement importants et n'h√©site pas √† former de jeunes joueurs. Par ailleurs, les clubs disposant de moyens financiers plus limit√©s ont souvent tendance √† faire davantage confiance aux jeunes joueurs, qui repr√©sentent une alternative plus √©conomique

```{r}

# Filtrer les jeunes joueurs 
jeunes_joueurs <- player_stats_2021_2022  %>%
  filter(Age < 22)

# Compter le nombre de jeunes joueurs par club
jeunes_par_club <- jeunes_joueurs %>%
  count(Squad, name = "nb_jeunes") %>%
  arrange(desc(nb_jeunes)) %>%
  top_n(10, nb_jeunes)

# Barplot horizontal
ggplot(jeunes_par_club, aes(x = reorder(Squad, nb_jeunes), y = nb_jeunes)) +
  geom_col(fill = "#66BB6A", width = 0.6) +  
  geom_text(aes(label = nb_jeunes), hjust = -0.1, size = 4, color = "black") +
  coord_flip(clip = "off") +
  labs(
    title = "Top 10 des clubs avec le plus de jeunes joueurs (< 22 ans)\nSaison 2021/22",
    x = NULL,
    y = "Nombre de jeunes joueurs"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    axis.text.y = element_text(face = "bold"),
    axis.text.x = element_text(color = "gray30"),
    panel.grid.major.y = element_blank(),  
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 20, 10, 10) 
  ) +
  ylim(0, max(jeunes_par_club$nb_jeunes) + 2)  

```

```{r}
# Filtrer les jeunes joueurs (<23 ans)
jeunes_joueurs <- player_stats_2021_2022 %>%
  filter(Age < 23)

# Calculer le total des minutes jou√©es par club (par les jeunes joueurs)
minutes_par_club <- jeunes_joueurs %>%
  group_by(Squad) %>%
  summarise(total_minutes = sum(Min, na.rm = TRUE)) %>%
  arrange(desc(total_minutes)) %>%
  slice_head(n = 10)  # Top 10 clubs

# Lollipop plot
ggplot(minutes_par_club, aes(x = reorder(Squad, total_minutes), y = total_minutes)) +
  geom_segment(aes(xend = Squad, y = 0, yend = total_minutes), color = "#4CAF50", size = 1.2) +
  geom_point(color = "#FBC02D", size = 6) +
  coord_flip() +
  labs(
    title = "Total des minutes jou√©es par les jeunes joueurs\npar club sur la saison 2021/22",
    x = "Club",
    y = "Minutes jou√©es"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_blank()
  )


```

#### üß† Interpr√©tation des graphiques:


- üîµ Certains clubs r√©put√©s pour leur formation ‚Äî **FC Barcelone**, **Borussia Dortmund**, **Bayer Leverkusen** ‚Äî offrent un temps de jeu cons√©quent √† leurs jeunes joueurs.

- üîµ La **Ligue 1** se distingue nettement : **6 clubs dans le top 15** en nombre de jeunes joueurs utilis√©s, **4 dans le top 10** en minutes jou√©es. Cela confirme une forte culture de formation et une int√©gration rapide des jeunes dans les effectifs.

- üîµ La **Liga espagnole** est moins repr√©sent√©e que pr√©vu, avec seulement deux clubs dans le top 15. Le **FC Barcelone** reste une exception forte, incarnant une politique claire de valorisation interne.

- üîµ Certains clubs comme **Reims**, **Bologne** ou **Valence** allient jeunesse de l‚Äôeffectif et temps de jeu √©lev√© pour ces joueurs, confirmant une strat√©gie de d√©veloppement assum√©e.

- üîµ Aucun lien direct n‚Äô√©merge entre le **budget** et l‚Äô**utilisation des jeunes** : m√™me les clubs les plus riches (**PSG**, **Milan AC**, **Bar√ßa**) misent fortement sur leur centre de formation. Cela montre que la formation est un levier strat√©gique, au-del√† des moyens financiers.



‚úÖ **Conclusion** :L‚Äôhypoth√®se est donc globalement confirm√©e : les clubs avec une strat√©gie de formation claire jouent davantage leurs jeunes talents, comme en t√©moignent les chiffres en nombre de joueurs et en minutes jou√©es. Cependant, la diversit√© des situations montre que ce n‚Äôest pas uniquement une question de moyens financiers, mais surtout d‚Äôefficacit√© des centres de formation et de la politique sportive adopt√©e. Cette analyse souligne donc l‚Äôimportance de la formation comme facteur cl√© de succ√®s pour les clubs souhaitant valoriser leurs jeunes joueurs sur le long terme

---

### **Question 10 : Quelles √©quipes sont les plus "chanceuses" ou "malchanceuses" ? **

#### üéØ Objectif:
Identifier les √©quipes dont le nombre de buts marqu√©s est significativement sup√©rieur ou inf√©rieur √† leur expected goals (xG) sur la saison 2021/2022. Cela permet de mettre en √©vidence celles qui d√©passent les attentes en convertissant efficacement leurs occasions (√©quipes ¬´ chanceuses ¬ª), et celles qui, malgr√© beaucoup d‚Äôoccasions cr√©√©es (xG √©lev√©), peinent √† concr√©tiser (√©quipes ¬´ malchanceuses ¬ª). On ne se basera que sur les grands championnats pour essayer d'√©tablir une corr√©lation avec la place dans le classement cette ann√©e la.


#### üß™ Hypoth√®se :

Il para√Æt plausible que les √©quipes les mieux class√©es dans leur championnat ont tendance √† √™tre ¬´ chanceuses ¬ª, c‚Äôest-√†-dire qu‚Äôelles marquent plus de buts que ce que leur expected goals (xG) pr√©dit, gr√¢ce √† une meilleure finition et une efficacit√© offensive sup√©rieure. En revanche, les √©quipes moins bien class√©es que ce qu'elle devrait, malgr√© un xG parfois √©lev√©, peinent √† convertir leurs occasions, ce qui les rend ¬´ malchanceuses ¬ª et refl√®te un manque de r√©alisme devant le but ou une qualit√© individuelle moindre.



```{r}
# On ajoute une colonne GF - xG (buts r√©els moins buts attendus)
team_stats_2021_2022$delta_goals <- team_stats_2021_2022$GF - team_stats_2021_2022$xG

top_chanceuses <- team_stats_2021_2022 %>%
  arrange(desc(delta_goals)) %>%
  slice_head(n = 10)

ggplot(top_chanceuses, aes(x = reorder(Squad, delta_goals), y = delta_goals)) +
  geom_col(fill = "#4CAF50", width = 0.6) +
  coord_flip(clip = "off") + 
  labs(
    title = "Top 10 √©quipes 'chanceuses' en 2021/2022",
    subtitle = "√âquipes ayant marqu√© plus de buts que leurs xG attendus",
    x = "√âquipe",
    y = "Diff√©rence buts r√©els - xG"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 11, face = "italic"),
    axis.title.x = element_text(face = "bold", size = 10),
    axis.title.y = element_text(face = "bold", size = 11),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 30, 10, 10)
  )




```

```{r}
# Top 10 √©quipes "malchanceuses" (delta_goals n√©gatif le plus bas)
top_malchanceuses <- team_stats_2021_2022 %>%
  arrange(delta_goals) %>%
  slice_head(n = 10)

ggplot(top_malchanceuses, aes(x = reorder(Squad, delta_goals), y = delta_goals)) +
  geom_col(fill = "#D32F2F", width = 0.6) +
  coord_flip(clip = "off") +
  labs(
    title = "Top 10 √©quipes 'malchanceuses' en 2021/2022",
    subtitle = "√âquipes avec un xG √©lev√© mais peu de buts marqu√©s",
    x = "√âquipe",
    y = "Diff√©rence buts r√©els - xG"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 11, face = "italic"),
    axis.title.x = element_text(face = "bold", size = 10),
    axis.title.y = element_text(face = "bold", size = 11),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank(),
    plot.margin = margin(10, 30, 10, 10)
  )



```

#### üß† Interpr√©tation du graphique:

- üîµ Une corr√©lation appara√Æt entre les √©quipes "chanceuses" (ayant marqu√© plus de buts que leurs xG) et leur performance en championnat.

- üîµ Parmi ces √©quipes : **Dortmund (2·µâ Bundesliga)**, **Lazio (5·µâ Serie A)**, **Rennes (4·µâ Ligue 1)**, **Leverkusen (3·µâ Bundesliga)**, **Naples (3·µâ Serie A)** et **PSG (champion de Ligue 1)**. Hormis les tr√®s grands clubs comme le PSG, ces √©quipes ont souvent r√©alis√© l‚Äôune de leurs meilleures saisons.

- üîµ Des clubs comme **Hellas V√©rone (9·µâ en Serie A cette saison-l√†, 17·µâ la suivante)** ou **Nantes (9·µâ en Ligue 1, contre 18·µâ puis 17·µâ les saisons encadrantes)** t√©moignent √©galement de performances sup√©rieures √† leur niveau habituel, sugg√©rant une **saison de surperformance**.

- üîµ √Ä l‚Äôinverse, les √©quipes "malchanceuses" (xG √©lev√©s mais peu de buts marqu√©s) sont souvent bien class√©es : **Real Sociedad (6·µâ)**, **Genoa (11·µâ)**, **Lorient (10·µâ)**, **Athletic Club (8·µâ)**, **Clermont (8·µâ)**, **Rayo Vallecano (12·µâ)**, **Wolfsburg (12·µâ)**. Leur bon classement s'explique par une capacit√© √† se cr√©er de nombreuses occasions, sans les concr√©tiser pleinement.

- üîµ Enfin, des √©quipes comme **Norwich** ou **Alav√©s**, derniers de leurs championnats, montrent que la "malchance" ne suffit pas toujours √† expliquer les r√©sultats : certaines saisons sont simplement rat√©es dans leur ensemble.


‚úÖ **Conclusion** :  

Les √©quipes "chanceuses", qui marquent plus que leurs expected goals (xG), sont souvent bien class√©es et en surperformance. √Ä l'inverse, certaines √©quipes "malchanceuses" restent comp√©titives malgr√© un manque d'efficacit√© offensive. L'√©cart entre buts et xG influence le classement, mais ne l'explique pas enti√®rement.

---

### **Question 11 : Les clubs ayant recrut√© plus de joueurs ont-ils mieux perform√© ? **

#### üéØ Objectif:
√âtudier s‚Äôil existe une relation entre le nombre de recrues lors du mercato estival 2022 et l‚Äô√©volution des performances sportives des clubs entre 2021-2022 et 2022-2023.

#### üß™ Hypoth√®se :
Nous formulons l‚Äôhypoth√®se que chaque d√©fenseur excelle dans un type d‚Äôintervention d√©fensive qui correspond √† :son style de jeu personnel,les besoins sp√©cifiques de son √©quipe, ou encore aux caract√©ristiques du championnat dans lequel il √©volue.
Par exemple, un joueur comme Virgil van Dijk pourrait exceller dans les duels a√©riens en raison du rythme physique de la Premier League, tandis que David Alaba aurait un profil plus polyvalent ou technique adapt√© au style de jeu du Real Madrid en Liga.


```{r}

# S√©lection des joueurs repr√©sentatifs par championnat
joueurs <- c("Virgil van Dijk", "Marquinhos", "Kalidou Koulibaly", "David Alaba")

# Cr√©ation des indicateurs normalis√©s par 90 minutes
defenseurs <- player_stats_2021_2022 %>%
  filter(Player %in% joueurs, X90s > 5) %>%
  mutate(
    Tacles90 = Tkl / X90s,
    Interceptions90 = Int / X90s,
    DuelsAerienPct = AerWon.,
    Blocs90 = Blocks / X90s,
    Degagements90 = Clr / X90s
  ) %>%
  select(Player, Tacles90, Interceptions90, DuelsAerienPct, Blocs90, Degagements90) %>%
  column_to_rownames("Player")

# Ajouter lignes max / min pour fmsb
radar_def <- rbind(
  apply(defenseurs, 2, max),
  apply(defenseurs, 2, min),
  defenseurs
)

# Renommer les colonnes pour plus de clart√©
colnames(radar_def) <- c(
  "Tacles/90m",
  "Interceptions/90m",
  "Duels a√©riens (%)",
  "Blocs/90m",
  "D√©gagements/90m"
)

# R√©duction des marges et affichage radar
par(mar = c(2, 2, 2, 2))

# Couleurs am√©lior√©es (Alaba passe en violet fonc√©)
radarchart(
  radar_def,
  axistype = 1,
  pcol = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"),  # rouge, bleu, vert, violet
  pfcol = c("#E41A1C50", "#377EB850", "#4DAF4A50", "#984EA350"),
  plwd = 2,
  cglcol = "grey",
  cglty = 1,
  axislabcol = "grey",
  vlcex = 0.9,
  title = "Profil d√©fensif des meilleurs d√©fenseurs par championnat (2021-2022)"
)

legend(
  "topright",
  legend = rownames(defenseurs),
  col = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"),
  lty = 1,
  lwd = 2,
  bty = "n"
)

```


#### üß† Interpr√©tation du graphique:

- üîµ Le radar chart permet de comparer les performances de Virgil van Dijk (Premier League), Marquinhos (Ligue 1), Kalidou Koulibaly (Serie A) et David Alaba (La Liga), chacun repr√©sent√© par une couleur distincte.

- üîµ Van Dijk domine nettement les duels a√©riens, ce qui confirme son r√¥le de tour de contr√¥le d√©fensive au sein de Liverpool et son importance dans le jeu a√©rien.

- üîµ Marquinhos pr√©sente un profil tr√®s √©quilibr√©, avec des performances solides sur l‚Äôensemble des dimensions d√©fensives, refl√©tant sa r√©gularit√© et sa polyvalence au PSG.

- üîµ Koulibaly se distingue particuli√®rement par son volume de d√©gagements et de blocs, traduisant une approche d√©fensive r√©active, physique et ax√©e sur l‚Äôinterruption du jeu adverse.

- üîµ Alaba, en revanche, affiche un profil moins bas√© sur l‚Äôimpact physique ; ses statistiques refl√®tent davantage son r√¥le hybride entre d√©fenseur et milieu dans un syst√®me de possession comme celui du Real Madrid.

‚úÖ **Conclusion** :  

Cette visualisation met en lumi√®re la diversit√© des profils d√©fensifs au plus haut niveau europ√©en. Chaque joueur excelle dans des dimensions diff√©rentes, illustrant que la performance d√©fensive ne se limite pas √† une seule statistique, mais d√©pend de l‚Äôenvironnement tactique, du style d‚Äô√©quipe et du championnat. Le radar chart est ici un outil efficace pour identifier les points forts et les sp√©cialisations de chacun, tout en offrant une repr√©sentation synth√©tique d‚Äôindicateurs h√©t√©rog√®nes mais compl√©mentaires.

---

### **Question 12 : Quels clubs sont les plus d√©pendants de leur meilleur buteur ?**

#### üéØ Objectif: 
√âvaluer dans quelle mesure chaque club d√©pend de son meilleur buteur pour marquer des buts lors de la saison 2021-2022.



#### üß™ Hypoth√®se :
Certains clubs d√©pendent fortement d‚Äôun seul joueur pour marquer des buts. Cette d√©pendance peut poser un risque strat√©gique (blessure, transfert, m√©forme).



```{r}
# Extraction depuis la colonne unique "Buteur"
team_stats_2021_2022 <- team_stats_2021_2022 %>%
  mutate(
    Nb_buts_buteur = str_extract(Top.Team.Scorer, "\\d+$"),            
    Buteur = str_remove(Top.Team.Scorer, "\\s*-\\s*\\d+$"),             
    Nb_buts_buteur = as.numeric(Nb_buts_buteur),
    dep_buteur = Nb_buts_buteur / GF
  )

# Top 10 des clubs les plus d√©pendants
top_dependance <- team_stats_2021_2022 %>%
  filter(!is.na(dep_buteur)) %>%
  arrange(desc(dep_buteur)) %>%
  slice_head(n = 10)

# Visualisation
ggplot(top_dependance, aes(x = reorder(Squad, dep_buteur), y = dep_buteur)) +
  geom_col(fill = "#0072B2") +
  coord_flip() +
  labs(
    title = "Top 10 des clubs les plus d√©pendants √† leur meilleur buteur (2021-2022)",
    x = "Club",
    y = "Part des buts marqu√©s par le meilleur buteur"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_minimal()

```


#### üß† Interpr√©tation du graphique:

- üîµ Le graphique illustre la part des buts marqu√©s par le meilleur buteur de chaque club, mettant en √©vidence leur d√©pendance offensive √† un seul joueur.

- üîµ Getafe est l‚Äô√©quipe la plus d√©pendante, avec pr√®s de 48 % de ses buts inscrits par Enes √únal, suivi de Norwich City, dont Teemu Pukki a marqu√© √©galement 48 % des buts du club.

- üîµ Des clubs comme Alav√©s ou Espanyol affichent eux aussi une forte d√©pendance offensive, d√©passant le seuil de 40 % de buts venant d‚Äôun seul joueur.

- üîµ Ce niveau de concentration du scoring rend ces √©quipes vuln√©rables : l‚Äôabsence ou la m√©forme de leur buteur principal peut fortement p√©naliser leur efficacit√© offensive globale.


‚úÖ **Conclusion** :  
Ce graphique met en √©vidence que certains clubs reposent quasiment √† moiti√© sur un seul joueur pour marquer. Cela sugg√®re une d√©pendance tactique risqu√©e, qui devrait √™tre prise en compte dans la strat√©gie sportive (recrutement, distribution du jeu, etc.).
√Ä l‚Äôinverse, les clubs avec une d√©pendance plus faible b√©n√©ficient d‚Äôun jeu offensif plus collectif, souvent plus r√©silient √† l‚Äô√©chelle d‚Äôune saison.

---

### **Question 13 : Les investissements ont-ils am√©lior√© les r√©sultats sportifs ? **

#### üéØ Objectif:
Analyser s‚Äôil existe une relation entre les montants investis par les clubs pendant le mercato estival 2022 et leur √©volution en termes de points entre les saisons 2021-2022 et 2022-2023.


#### üß™ Hypoth√®se :
Les clubs ayant d√©pens√© davantage lors du mercato estival 2022 ont obtenu de meilleurs r√©sultats sportifs la saison suivante.

```{r}
# Nettoyage de la variable "fee" (valeur du transfert)
transfers_clean <- transfers_2022 %>%
  filter(!fee %in% c("Free", "Loan", "", NA)) %>%
  mutate(fee = str_remove_all(fee, "‚Ç¨|m|\\s"),
         fee = as.numeric(fee))  # en millions d‚Äôeuros

# Calcul des investissements totaux par club d‚Äôarriv√©e
investissements <- transfers_clean %>%
  group_by(club_to) %>%
  summarise(invest_total = sum(fee, na.rm = TRUE))

# Pr√©parer la table avec variation de points
variation_points <- team_stats_2022_2023 %>%
  select(Squad, Pts) %>%
  rename(club_to = Squad, Pts_22_23 = Pts) %>%
  left_join(select(team_stats_2021_2022, Squad, Pts), by = c("club_to" = "Squad")) %>%
  rename(Pts_21_22 = Pts) %>%
  mutate(variation_pts = Pts_22_23 - Pts_21_22)

# Fusion des donn√©es
df_invest <- left_join(variation_points, investissements, by = "club_to") %>%
  filter(!is.na(invest_total))

# Graphique : r√©gression + intervalle de confiance
ggplot(df_invest, aes(x = invest_total, y = variation_pts)) +
  geom_point(size = 3, alpha = 0.7, color = "#E69F00") +
  geom_smooth(
    method = "lm",
    se = TRUE,
    level = 0.50,  
    color = "black",
    fill = "grey70",
    alpha = 0.4,
    linetype = "dashed"
  ) +
  labs(
    title = "Lien entre investissement estival et progression en points",
    x = "Montant investi (en millions ‚Ç¨)",
    y = "√âvolution du nombre de points"
  ) +
  theme_minimal()
```


#### üß† Interpr√©tation du graphique:

- üîµ Le graphique met en relation le montant investi par chaque club lors du mercato estival 2022 avec la variation de points obtenue entre les saisons 2021-2022 et 2022-2023.

- üîµ Chaque point repr√©sente un club, avec l‚Äôaxe horizontal indiquant le montant total investi (en M‚Ç¨), et l‚Äôaxe vertical montrant l‚Äô√©volution du nombre de points sur une saison.

- üîµ La droite de r√©gression affiche une l√©g√®re pente n√©gative, sugg√©rant qu‚Äôen moyenne, les clubs les plus d√©pensiers n‚Äôont pas forc√©ment progress√© en termes de r√©sultats sportifs.



‚úÖ **Conclusion** :  

Cette visualisation sugg√®re que les investissements √©lev√©s ne se traduisent pas syst√©matiquement par une am√©lioration des r√©sultats sportifs.
Au contraire, la tendance observ√©e dans notre √©chantillon montre une corr√©lation l√©g√®rement n√©gative entre les montants investis et la progression en points.
Ce r√©sultat met en √©vidence que le budget seul ne suffit pas : la qualit√© du recrutement, l‚Äôint√©gration des joueurs, la strat√©gie de jeu ou encore la stabilit√© de l‚Äôeffectif peuvent jouer un r√¥le plus important que la d√©pense brute.
---

### **Question 14 : Quels sont les meilleurs milieux de terrain en termes de cr√©ation ?**

#### üéØ Objectif:
Identifier les milieux de terrain les plus cr√©atifs lors de la saison 2021-2022 en combinant plusieurs indicateurs : passes cl√©s, passes d√©cisives, passes dans la surface, et passes menant √† des tirs.



#### üß™ Hypoth√®se :
Un milieu cr√©atif ne se limite pas aux passes d√©cisives. Les meilleurs cr√©ateurs sont ceux qui pr√©parent les occasions, p√©n√®trent dans les zones dangereuses et participent activement √† la construction offensive.


```{r}
# S√©lection des milieux ayant jou√© au moins 10 matchs et disponibles dans les bonnes colonnes
milieux <- player_stats_2021_2022 %>%
  filter(Pos %in% c("MF", "CM", "DM", "AM")) %>%
  filter(MP >= 10) %>%
  select(Player, Squad, Pos, MP, Assists, PasAss, PPA, ScaPassLive) %>%
  mutate(note_creation = (Assists + PasAss + PPA + ScaPassLive) / MP) %>%
  arrange(desc(note_creation)) %>%
  slice_head(n = 10)
ggplot(milieux, aes(x = reorder(Player, note_creation), y = note_creation, fill = Squad)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Top 10 des milieux les plus cr√©atifs (2021-2022)",
    x = "Joueur",
    y = "Indice de cr√©ation par match"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")

```


#### üß† Interpr√©tation du graphique:

- üîµ L‚Äôindice pr√©sent√© combine quatre dimensions cl√©s de la cr√©ation offensive : Assists (passes d√©cisives), PasAss (passes cl√©s), PPA (passes vers la surface), et ScaPassLive (passes en jeu menant √† un tir).

- üîµ En rapportant ces donn√©es au nombre de matchs jou√©s, on obtient un indice normalis√©, ce qui permet une comparaison √©quitable entre joueurs, quelle que soit leur dur√©e de jeu.

- üîµ Cet indice offre une vision globale de la contribution offensive par la passe, en allant au-del√† des seules passes d√©cisives pour inclure la pr√©paration des actions dangereuses.

‚úÖ **Conclusion** :  

Cette approche met en lumi√®re les milieux les plus impliqu√©s dans la cr√©ation offensive, qu‚Äôils soient passeurs d√©cisifs, r√©gulateurs du jeu ou moteurs de la progression du ballon.
Elle montre que la cr√©ativit√© ne se limite pas aux passes d√©cisives visibles, mais aussi √† la construction d‚Äôoccasions, essentielle au jeu moderne.

---

### **Question 15 : Volume des transferts par ligue de d√©part ** 

#### üéØ Objectif:
Analyser quel championnat (ligue) est √† l‚Äôorigine du plus grand nombre de transferts durant l‚Äô√©t√© 2022. Cela aide √† rep√©rer les championnats qui forment beaucoup de joueurs ou qui ont une strat√©gie de vente active.

#### üß™ Hypoth√®se :
Les ligues les plus r√©put√©es financi√®rement (ex : Premier League, Liga, Bundesliga) exportent plus de joueurs, mais certains championnats moins connus (Am√©rique du Sud) peuvent aussi √™tre des promoteurs importants de jeunes talents.

#### üß† Interpr√©tation du graphique:
Le graphique montre les 15 premi√®res ligues (hors 2e et 3e divisions) class√©es selon leur nombre de joueurs transf√©r√©s.
On remarque que les 5 grands championnats sont en haut du classement comme pr√©vu mais √©tonnemment la ligue turque ou m√™me la ligue 2 fran√ßaise ont un nombre de transferts plus √©lev√© que la ligue br√©silienne. Cela peut provenir du fait qu'√† cette ann√©e il y'a eu manque de talents provenants de ces pays.

```{r}

```


---

### **Question 16 : Valeur marchande des transferts selon pays et ligue de d√©part**

#### üéØ Objectif:
Analyser la r√©partition de la valeur totale des transferts selon le pays et la ligue d‚Äôorigine des joueurs. Cela permet de mieux comprendre o√π les clubs arrivent √† faire de bons retour sur investissement et d‚Äôidentifier les march√©s les plus chers.

#### üß™ Hypoth√®se :
Les pays et ligues les plus riches ou les plus attractifs devraient g√©n√©rer des transferts avec des valeurs plus √©lev√©es. On s‚Äôattend donc √† une concentration forte sur quelques ligues majeures (le top 5 ligues europ√©ennes).


```{r}

```


#### üß† Interpr√©tation du graphique:
- üîµ Le graphique illustre clairement que certaines ligues et pays (comme √©nonc√© dans l'hypoth√®se, le top 5 ligues Euro) dominent le march√© par la valeur financi√®re des transferts.

- üîµ L‚Äô√©chelle logarithmique permet de bien voir les diff√©rences entre ligues majeures et mineures.

- üîµ La table d√©taille les valeurs pr√©cises, facilitant les comparaisons.


‚úÖ **Conclusion** :  
Les investissements sont concentr√©s dans un petit nombre de ligues majeures, confirmant l‚Äôhypoth√®se. Cette analyse financi√®re compl√®te l‚Äôanalyse quantitative du volume des transferts. Cela confirme que les grands championnats ont un pouvoir de n√©gociation bien plus fort. On voit aussi que la valeur d‚Äôun joueur ne d√©pend pas uniquement de son talent, mais aussi de son championnat d‚Äôorigine et de sa visibilit√© m√©diatique.


---

### **Question 17 : **

#### üéØ Objectif:


#### üß™ Hypoth√®se :



```{r}

```


#### üß† Interpr√©tation du graphique:


‚úÖ **Conclusion** :  

---

### **Question 18 : **

#### üéØ Objectif:


#### üß™ Hypoth√®se :



```{r}

```


#### üß† Interpr√©tation du graphique:


‚úÖ **Conclusion** :  

---

### **Question 19 : **

#### üéØ Objectif:


#### üß™ Hypoth√®se :



```{r}

```


#### üß† Interpr√©tation du graphique:


‚úÖ **Conclusion** :  

---

### **Question 20 : **

#### üéØ Objectif:


#### üß™ Hypoth√®se :



```{r}

```


#### üß† Interpr√©tation du graphique:


‚úÖ **Conclusion** :  



